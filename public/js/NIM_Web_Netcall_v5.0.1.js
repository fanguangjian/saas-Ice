!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Netcall=e():t.Netcall=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}({0:function(t,e,n){"use strict";var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o="5.0.1",r="2.6.0.328";n(41);var s=n(237),a=n(133),c=n(190),u=n(235),l=n(115),d=n(199),h=n(200),p=n(201),f=void 0,m=i({version:o,versionAgent:r},l,{webgl:s,install:function(t,e){a.install(t,e),c.install(t,e),t.parser.mixin({configMap:d,serializeMap:h,unserializeMap:p}),u.install(t,e)},getInstance:function(t){return f||(f=new u(t)),f},destroy:function(){f&&(f.destroy(),f=null)}});t.exports=m},2:function(t,e,n){(function(e){"use strict";var n="1564b2bbba9ebb123ba972124cc34a0d2ecc3b23",i="1564b2bb",o="5.0.1",r="2.6.0.328",s="3.9.0",a="47",c="1",u=1,l="https://lbs.netease.im/lbs/webconf.jsp",d="roomserver.netease.im",h="https://dr.netease.im/1.gif",p="development"===e.env.NODE_ENV?6e3:42e3,f={info:{hash:n,shortHash:i,version:o,sdkVersion:a,nrtcVersion:s,nrtcSdkVersion:c,protocolVersion:u},agentVersion:r,lbsUrl:l,roomserver:d,connectTimeout:p,xhrTimeout:p,socketTimeout:p,reconnectionDelay:656.25,reconnectionDelayMax:p,reconnectionJitter:.1,heartbeatInterval:18e4,cmdTimeout:p,defaultReportUrl:h};f.formatSocketUrl=function(t){var e=t.url,n=t.secure,i=n?"https":"http";return e.indexOf("http")===-1?i+"://"+e:e},f.uploadUrl="https://nos.netease.com",f.replaceUrl="https://{bucket}.nosdn.127.net/{object}",f.downloadHost="nos.netease.com",f.downloadUrl="https://{bucket}.nosdn.127.net/{object}",f.httpsEnabled=!1,f.genUploadUrl=function(t){return f.uploadUrl+"/"+t},f.genDownloadUrl=function(t,e){var n=f.replaceUrl;return/^http/.test(n)?f.httpsEnabled&&(n=n.replace("http","https")):n=f.httpsEnabled?"https://"+n:"http://"+n,n.replace("{bucket}",t).replace("{object}",e)},t.exports=f}).call(e,n(8))},3:function(t,e,n){(function(e,i){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   4.0.5
	 */
!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function o(t){return"function"==typeof t}function r(t){X=t}function s(t){J=t}function a(){return function(){return e.nextTick(h)}}function c(){return"undefined"!=typeof Q?function(){Q(h)}:d()}function u(){var t=0,e=new Z(h),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function l(){var t=new MessageChannel;return t.port1.onmessage=h,function(){return t.port2.postMessage(0)}}function d(){var t=setTimeout;return function(){return t(h,1)}}function h(){for(var t=0;t<q;t+=2){var e=nt[t],n=nt[t+1];e(n),nt[t]=void 0,nt[t+1]=void 0}q=0}function p(){try{var t=n(26);return Q=t.runOnLoop||t.runOnContext,c()}catch(e){return d()}}function f(t,e){var n=arguments,i=this,o=new this.constructor(v);void 0===o[ot]&&P(o);var r=i._state;return r?!function(){var t=n[r-1];J(function(){return N(r,o,t,i._result)})}():I(i,o,t,e),o}function m(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(v);return A(n,t),n}function v(){}function _(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function y(t){try{return t.then}catch(e){return ct.error=e,ct}}function b(t,e,n,i){try{t.call(e,n,i)}catch(o){return o}}function C(t,e,n){J(function(t){var i=!1,o=b(n,e,function(n){i||(i=!0,e!==n?A(t,n):O(t,n))},function(e){i||(i=!0,w(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&o&&(i=!0,w(t,o))},t)}function T(t,e){e._state===st?O(t,e._result):e._state===at?w(t,e._result):I(e,void 0,function(e){return A(t,e)},function(e){return w(t,e)})}function S(t,e,n){e.constructor===t.constructor&&n===f&&e.constructor.resolve===m?T(t,e):n===ct?w(t,ct.error):void 0===n?O(t,e):o(n)?C(t,e,n):O(t,e)}function A(e,n){e===n?w(e,_()):t(n)?S(e,n,y(n)):O(e,n)}function E(t){t._onerror&&t._onerror(t._result),M(t)}function O(t,e){t._state===rt&&(t._result=e,t._state=st,0!==t._subscribers.length&&J(M,t))}function w(t,e){t._state===rt&&(t._state=at,t._result=e,J(E,t))}function I(t,e,n,i){var o=t._subscribers,r=o.length;t._onerror=null,o[r]=e,o[r+st]=n,o[r+at]=i,0===r&&t._state&&J(M,t)}function M(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,o=void 0,r=t._result,s=0;s<e.length;s+=3)i=e[s],o=e[s+n],i?N(n,i,o,r):o(r);t._subscribers.length=0}}function x(){this.error=null}function k(t,e){try{return t(e)}catch(n){return ut.error=n,ut}}function N(t,e,n,i){var r=o(n),s=void 0,a=void 0,c=void 0,u=void 0;if(r){if(s=k(n,i),s===ut?(u=!0,a=s.error,s=null):c=!0,e===s)return void w(e,g())}else s=i,c=!0;e._state!==rt||(r&&c?A(e,s):u?w(e,a):t===st?O(e,s):t===at&&w(e,s))}function j(t,e){try{e(function(e){A(t,e)},function(e){w(t,e)})}catch(n){w(t,n)}}function R(){return lt++}function P(t){t[ot]=lt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function L(t,e){this._instanceConstructor=t,this.promise=new t(v),this.promise[ot]||P(this.promise),z(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&O(this.promise,this._result))):w(this.promise,D())}function D(){return new Error("Array Methods must be provided an Array")}function U(t){return new L(this,t).promise}function V(t){var e=this;return new e(z(t)?function(n,i){for(var o=t.length,r=0;r<o;r++)e.resolve(t[r]).then(n,i)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function F(t){var e=this,n=new e(v);return w(n,t),n}function W(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function B(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function H(t){this[ot]=R(),this._result=this._state=void 0,this._subscribers=[],v!==t&&("function"!=typeof t&&W(),this instanceof H?j(this,t):B())}function Y(){var t=void 0;if("undefined"!=typeof i)t=i;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var o=null;try{o=Object.prototype.toString.call(n.resolve())}catch(e){}if("[object Promise]"===o&&!n.cast)return}t.Promise=H}var G=void 0;G=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var z=G,q=0,Q=void 0,X=void 0,J=function(t,e){nt[q]=t,nt[q+1]=e,q+=2,2===q&&(X?X(h):it())},K="undefined"!=typeof window?window:void 0,$=K||{},Z=$.MutationObserver||$.WebKitMutationObserver,tt="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),et="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,nt=new Array(1e3),it=void 0;it=tt?a():Z?u():et?l():void 0===K?p():d();var ot=Math.random().toString(36).substring(16),rt=void 0,st=1,at=2,ct=new x,ut=new x,lt=0;return L.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===rt&&n<t;n++)this._eachEntry(e[n],n)},L.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===m){var o=y(t);if(o===f&&t._state!==rt)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===H){var r=new n(v);S(r,t,o),this._willSettleAt(r,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(i(t),e)},L.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===rt&&(this._remaining--,t===at?w(i,n):this._result[e]=n),0===this._remaining&&O(i,this._result)},L.prototype._willSettleAt=function(t,e){var n=this;I(t,void 0,function(t){return n._settledAt(st,e,t)},function(t){return n._settledAt(at,e,t)})},H.all=U,H.race=V,H.resolve=m,H.reject=F,H._setScheduler=r,H._setAsap=s,H._asap=J,H.prototype={constructor:H,then:f,"catch":function(t){return this.then(null,t)}},H.polyfill=Y,H.Promise=H,H})}).call(e,n(8),function(){return this}())},4:function(t,e,n){"use strict";function i(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(){this._events=new i,this._eventsCount=0}var s=Object.prototype.hasOwnProperty,a="~";Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(a=!1)),r.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)s.call(t,e)&&n.push(a?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},r.prototype.listeners=function(t,e){var n=a?a+t:t,i=this._events[n];if(e)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var o=0,r=i.length,s=new Array(r);o<r;o++)s[o]=i[o].fn;return s},r.prototype.emit=function(t,e,n,i,o,r){var s=a?a+t:t;if(!this._events[s])return!1;var c,u,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,i),!0;case 5:return l.fn.call(l.context,e,n,i,o),!0;case 6:return l.fn.call(l.context,e,n,i,o,r),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,n);break;case 4:l[u].fn.call(l[u].context,e,n,i);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},r.prototype.on=function(t,e,n){var i=new o(e,n||this),r=a?a+t:t;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},r.prototype.once=function(t,e,n){var i=new o(e,n||this,!0),r=a?a+t:t;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},r.prototype.removeListener=function(t,e,n,o){var r=a?a+t:t;if(!this._events[r])return this;if(!e)return 0===--this._eventsCount?this._events=new i:delete this._events[r],this;var s=this._events[r];if(s.fn)s.fn!==e||o&&!s.once||n&&s.context!==n||(0===--this._eventsCount?this._events=new i:delete this._events[r]);else{for(var c=0,u=[],l=s.length;c<l;c++)(s[c].fn!==e||o&&!s[c].once||n&&s[c].context!==n)&&u.push(s[c]);u.length?this._events[r]=1===u.length?u[0]:u:0===--this._eventsCount?this._events=new i:delete this._events[r]}return this},r.prototype.removeAllListeners=function(t){var e;return t?(e=a?a+t:t,this._events[e]&&(0===--this._eventsCount?this._events=new i:delete this._events[e])):(this._events=new i,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=a,r.EventEmitter=r,t.exports=r},8:function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function r(t){if(d===clearTimeout)return clearTimeout(t);if((d===i||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{return d(t)}catch(e){try{return d.call(null,t)}catch(e){return d.call(this,t)}}}function s(){m&&p&&(m=!1,p.length?f=p.concat(f):v=-1,f.length&&a())}function a(){if(!m){var t=o(s);m=!0;for(var e=f.length;e;){for(p=f,f=[];++v<e;)p&&p[v].run();v=-1,e=f.length}p=null,m=!1,r(t)}}function c(t,e){this.fun=t,this.array=e}function u(){}var l,d,h=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{d="function"==typeof clearTimeout?clearTimeout:i}catch(t){d=i}}();var p,f=[],m=!1,v=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new c(t,e)),1!==f.length||m||o(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},9:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(38);Object.defineProperty(e,"ajax",{enumerable:!0,get:function(){return i(o)["default"]}});var r=n(47);Object.defineProperty(e,"element",{enumerable:!0,get:function(){return i(r)["default"]}});var s=n(39);Object.defineProperty(e,"tool",{enumerable:!0,get:function(){return i(s)["default"]}})},11:function(t,e,n){var i;(function(t,o){(function(){"use strict";function r(t){return t=String(t),t.charAt(0).toUpperCase()+t.slice(1)}function s(t,e,n){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return e&&n&&/^Win/i.test(t)&&!/^Windows Phone /i.test(t)&&(i=i[/[\d.]+$/.exec(t)])&&(t="Windows "+i),t=String(t),e&&n&&(t=t.replace(RegExp(e,"i"),n)),t=c(t.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function a(t,e){var n=-1,i=t?t.length:0;if("number"==typeof i&&i>-1&&i<=C)for(;++n<i;)e(t[n],n,t);else u(t,e)}function c(t){return t=f(t),/^(?:webOS|i(?:OS|P))/.test(t)?t:r(t)}function u(t,e){for(var n in t)A.call(t,n)&&e(t[n],n,t)}function l(t){return null==t?r(t):E.call(t).slice(8,-1)}function d(t,e){var n=null!=t?typeof t[e]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(n)||"object"==n&&!t[e])}function h(t){return String(t).replace(/([ -])(?!$)/g,"$1?")}function p(t,e){var n=null;return a(t,function(i,o){n=e(n,i,o,t)}),n}function f(t){return String(t).replace(/^ +| +$/g,"")}function m(t){function e(e){return p(e,function(e,n){return e||RegExp("\\b"+(n.pattern||h(n))+"\\b","i").exec(t)&&(n.label||n)})}function n(e){return p(e,function(e,n,i){return e||(n[z]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(z)]||RegExp("\\b"+h(i)+"(?:\\b|\\w*\\d)","i").exec(t))&&i})}function i(e){return p(e,function(e,n){return e||RegExp("\\b"+(n.pattern||h(n))+"\\b","i").exec(t)&&(n.label||n)})}function o(e){return p(e,function(e,n){var i=n.pattern||h(n);return!e&&(e=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=s(e,i,n.label||n)),e})}function r(e){return p(e,function(e,n){var i=n.pattern||h(n);return!e&&(e=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(i,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=c(e[0].replace(RegExp(i,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e})}function a(e){return p(e,function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null})}function v(){return this.description||""}var g=_,y=t&&"object"==typeof t&&"String"!=l(t);y&&(g=t,t=null);var b=g.navigator||{},C=b.userAgent||"";t||(t=C);var S,A,O=y?!!b.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(E.toString()),w="Object",I=y?w:"ScriptBridgingProxyObject",M=y?w:"Environment",x=y&&g.java?"JavaPackage":l(g.java),k=y?w:"RuntimeObject",N=/\bJava/.test(x)&&g.java,j=N&&l(g.environment)==M,R=N?"a":"α",P=N?"b":"β",L=g.document||{},D=g.operamini||g.opera,U=T.test(U=y&&D?D["[[Class]]"]:l(D))?U:D=null,V=t,F=[],W=null,B=t==C,H=B&&D&&"function"==typeof D.version&&D.version(),Y=e([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),G=i(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),z=r([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),q=n({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),Q=o(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(Y&&(Y=[Y]),q&&!z&&(z=r([q])),(S=/\bGoogle TV\b/.exec(z))&&(z=S[0]),/\bSimulator\b/i.test(t)&&(z=(z?z+" ":"")+"Simulator"),"Opera Mini"==G&&/\bOPiOS\b/.test(t)&&F.push("running in Turbo/Uncompressed mode"),"IE"==G&&/\blike iPhone OS\b/.test(t)?(S=m(t.replace(/like iPhone OS/,"")),q=S.manufacturer,z=S.product):/^iP/.test(z)?(G||(G="Safari"),Q="iOS"+((S=/ OS ([\d_]+)/i.exec(t))?" "+S[1].replace(/_/g,"."):"")):"Konqueror"!=G||/buntu/i.test(Q)?q&&"Google"!=q&&(/Chrome/.test(G)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(z))||/\bAndroid\b/.test(Q)&&/^Chrome/.test(G)&&/\bVersion\//i.test(t)?(G="Android Browser",Q=/\bAndroid\b/.test(Q)?Q:"Android"):"Silk"==G?(/\bMobi/i.test(t)||(Q="Android",F.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&F.unshift("accelerated")):"PaleMoon"==G&&(S=/\bFirefox\/([\d.]+)\b/.exec(t))?F.push("identifying as Firefox "+S[1]):"Firefox"==G&&(S=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(Q||(Q="Firefox OS"),z||(z=S[1])):!G||(S=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(G))?(G&&!z&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(S+"/")+8))&&(G=null),(S=z||q||Q)&&(z||q||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Q))&&(G=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Q)?Q:S)+" Browser")):"Electron"==G&&(S=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&F.push("Chromium "+S):Q="Kubuntu",H||(H=a(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",h(G),"(?:Firefox|Minefield|NetFront)"])),(S="iCab"==Y&&parseFloat(H)>3&&"WebKit"||/\bOpera\b/.test(G)&&(/\bOPR\b/.test(t)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(Y)&&"WebKit"||!Y&&/\bMSIE\b/i.test(t)&&("Mac OS"==Q?"Tasman":"Trident")||"WebKit"==Y&&/\bPlayStation\b(?! Vita\b)/i.test(G)&&"NetFront")&&(Y=[S]),"IE"==G&&(S=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(G+=" Mobile",Q="Windows Phone "+(/\+$/.test(S)?S:S+".x"),F.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(G="IE Mobile",Q="Windows Phone 8.x",F.unshift("desktop mode"),H||(H=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=G&&"Trident"==Y&&(S=/\brv:([\d.]+)/.exec(t))&&(G&&F.push("identifying as "+G+(H?" "+H:"")),G="IE",H=S[1]),B){if(d(g,"global"))if(N&&(S=N.lang.System,V=S.getProperty("os.arch"),Q=Q||S.getProperty("os.name")+" "+S.getProperty("os.version")),j){try{H=g.require("ringo/engine").version.join("."),G="RingoJS"}catch(X){(S=g.system)&&S.global.system==g.system&&(G="Narwhal",Q||(Q=S[0].os||null))}G||(G="Rhino")}else"object"==typeof g.process&&!g.process.browser&&(S=g.process)&&("object"==typeof S.versions&&("string"==typeof S.versions.electron?(F.push("Node "+S.versions.node),G="Electron",H=S.versions.electron):"string"==typeof S.versions.nw&&(F.push("Chromium "+H,"Node "+S.versions.node),G="NW.js",H=S.versions.nw)),G||(G="Node.js",V=S.arch,Q=S.platform,H=/[\d.]+/.exec(S.version),H=H?H[0]:null));else l(S=g.runtime)==I?(G="Adobe AIR",Q=S.flash.system.Capabilities.os):l(S=g.phantom)==k?(G="PhantomJS",H=(S=S.version||null)&&S.major+"."+S.minor+"."+S.patch):"number"==typeof L.documentMode&&(S=/\bTrident\/(\d+)/i.exec(t))?(H=[H,L.documentMode],(S=+S[1]+4)!=H[1]&&(F.push("IE "+H[1]+" mode"),Y&&(Y[1]=""),H[1]=S),H="IE"==G?String(H[1].toFixed(1)):H[0]):"number"==typeof L.documentMode&&/^(?:Chrome|Firefox)\b/.test(G)&&(F.push("masking as "+G+" "+H),G="IE",H="11.0",Y=["Trident"],Q="Windows");Q=Q&&c(Q)}if(H&&(S=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(H)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(B&&b.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(W=/b/i.test(S)?"beta":"alpha",H=H.replace(RegExp(S+"\\+?$"),"")+("beta"==W?P:R)+(/\d+\+?/.exec(S)||"")),"Fennec"==G||"Firefox"==G&&/\b(?:Android|Firefox OS)\b/.test(Q))G="Firefox Mobile";else if("Maxthon"==G&&H)H=H.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(z))"Xbox 360"==z&&(Q=null),"Xbox 360"==z&&/\bIEMobile\b/.test(t)&&F.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(G)&&(!G||z||/Browser|Mobi/.test(G))||"Windows CE"!=Q&&!/Mobi/i.test(t))if("IE"==G&&B)try{null===g.external&&F.unshift("platform preview")}catch(X){F.unshift("embedded")}else(/\bBlackBerry\b/.test(z)||/\bBB10\b/.test(t))&&(S=(RegExp(z.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||H)?(S=[S,/BB10/.test(t)],Q=(S[1]?(z=null,q="BlackBerry"):"Device Software")+" "+S[0],H=null):this!=u&&"Wii"!=z&&(B&&D||/Opera/.test(G)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==G&&/\bOS X (?:\d+\.){2,}/.test(Q)||"IE"==G&&(Q&&!/^Win/.test(Q)&&H>5.5||/\bWindows XP\b/.test(Q)&&H>8||8==H&&!/\bTrident\b/.test(t)))&&!T.test(S=m.call(u,t.replace(T,"")+";"))&&S.name&&(S="ing as "+S.name+((S=S.version)?" "+S:""),T.test(G)?(/\bIE\b/.test(S)&&"Mac OS"==Q&&(Q=null),S="identify"+S):(S="mask"+S,G=U?c(U.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(S)&&(Q=null),B||(H=null)),Y=["Presto"],F.push(S));else G+=" Mobile";(S=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(S=[parseFloat(S.replace(/\.(\d)$/,".0$1")),S],"Safari"==G&&"+"==S[1].slice(-1)?(G="WebKit Nightly",W="alpha",H=S[1].slice(0,-1)):H!=S[1]&&H!=(S[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(H=null),S[1]=(/\bChrome\/([\d.]+)/i.exec(t)||0)[1],537.36==S[0]&&537.36==S[2]&&parseFloat(S[1])>=28&&"WebKit"==Y&&(Y=["Blink"]),B&&(O||S[1])?(Y&&(Y[1]="like Chrome"),S=S[1]||(S=S[0],S<530?1:S<532?2:S<532.05?3:S<533?4:S<534.03?5:S<534.07?6:S<534.1?7:S<534.13?8:S<534.16?9:S<534.24?10:S<534.3?11:S<535.01?12:S<535.02?"13+":S<535.07?15:S<535.11?16:S<535.19?17:S<536.05?18:S<536.1?19:S<537.01?20:S<537.11?"21+":S<537.13?23:S<537.18?24:S<537.24?25:S<537.36?26:"Blink"!=Y?"27":"28")):(Y&&(Y[1]="like Safari"),S=S[0],S=S<400?1:S<500?2:S<526?3:S<533?4:S<534?"4+":S<535?5:S<537?6:S<538?7:S<601?8:"8"),Y&&(Y[1]+=" "+(S+="number"==typeof S?".x":/[.+]/.test(S)?"":"+")),"Safari"==G&&(!H||parseInt(H)>45)&&(H=S)),"Opera"==G&&(S=/\bzbov|zvav$/.exec(Q))?(G+=" ",F.unshift("desktop mode"),"zvav"==S?(G+="Mini",H=null):G+="Mobile",Q=Q.replace(RegExp(" *"+S+"$"),"")):"Safari"==G&&/\bChrome\b/.exec(Y&&Y[1])&&(F.unshift("desktop mode"),G="Chrome Mobile",H=null,/\bOS X\b/.test(Q)?(q="Apple",Q="iOS 4.3+"):Q=null),H&&0==H.indexOf(S=/[\d.]+$/.exec(Q))&&t.indexOf("/"+S+"-")>-1&&(Q=f(Q.replace(S,""))),Y&&!/\b(?:Avant|Nook)\b/.test(G)&&(/Browser|Lunascape|Maxthon/.test(G)||"Safari"!=G&&/^iOS/.test(Q)&&/\bSafari\b/.test(Y[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(G)&&Y[1])&&(S=Y[Y.length-1])&&F.push(S),F.length&&(F=["("+F.join("; ")+")"]),q&&z&&z.indexOf(q)<0&&F.push("on "+q),z&&F.push((/^on /.test(F[F.length-1])?"":"on ")+z),Q&&(S=/ ([\d.+]+)$/.exec(Q),A=S&&"/"==Q.charAt(Q.length-S[0].length-1),Q={architecture:32,family:S&&!A?Q.replace(S[0],""):Q,version:S?S[1]:null,toString:function(){var t=this.version;return this.family+(t&&!A?" "+t:"")+(64==this.architecture?" 64-bit":"")}}),(S=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(V))&&!/\bi686\b/i.test(V)?(Q&&(Q.architecture=64,Q.family=Q.family.replace(RegExp(" *"+S),"")),G&&(/\bWOW64\b/i.test(t)||B&&/\w(?:86|32)$/.test(b.cpuClass||b.platform)&&!/\bWin64; x64\b/i.test(t))&&F.unshift("32-bit")):Q&&/^OS X/.test(Q.family)&&"Chrome"==G&&parseFloat(H)>=39&&(Q.architecture=64),t||(t=null);var J={};return J.description=t,J.layout=Y&&Y[0],J.manufacturer=q,J.name=G,J.prerelease=W,J.product=z,J.ua=t,J.version=G&&H,J.os=Q||{architecture:null,family:null,version:null,toString:function(){return"null"}},J.parse=m,J.toString=v,J.version&&F.unshift(H),J.name&&F.unshift(G),Q&&G&&(Q!=String(Q).split(" ")[0]||Q!=G.split(" ")[0]&&!z)&&F.push(z?"("+Q+")":"on "+Q),F.length&&(J.description=F.join(" ")),J}var v={"function":!0,object:!0},_=v[typeof window]&&window||this,g=v[typeof e]&&e,y=v[typeof t]&&t&&!t.nodeType&&t,b=g&&y&&"object"==typeof o&&o;!b||b.global!==b&&b.window!==b&&b.self!==b||(_=b);var C=Math.pow(2,53)-1,T=/\bOpera/,S=Object.prototype,A=S.hasOwnProperty,E=S.toString,O=m();_.platform=O,i=function(){return O}.call(e,n,e,t),!(void 0!==i&&(t.exports=i))}).call(this)}).call(e,n(15)(t),function(){return this}())},15:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},25:function(t,e,n){var i,o;!function(r,s){"use strict";i=s,o="function"==typeof i?i.call(e,n,e,t):i,!(void 0!==o&&(t.exports=o))}(this,function(){var t,e,n,i,o=Function.call,r=Object.prototype,s=o.bind(r.hasOwnProperty),a=o.bind(r.propertyIsEnumerable),c=o.bind(r.toString),u=s(r,"__defineGetter__");u&&(t=o.bind(r.__defineGetter__),e=o.bind(r.__defineSetter__),n=o.bind(r.__lookupGetter__),i=o.bind(r.__lookupSetter__));var l=function(t){return null==t||"object"!=typeof t&&"function"!=typeof t};Object.getPrototypeOf||(Object.getPrototypeOf=function(t){var e=t.__proto__;return e||null===e?e:"[object Function]"===c(t.constructor)?t.constructor.prototype:t instanceof Object?r:null});var d=function(t){try{return t.sentinel=0,0===Object.getOwnPropertyDescriptor(t,"sentinel").value}catch(e){return!1}};if(Object.defineProperty){var h=d({}),p="undefined"==typeof document||d(document.createElement("div"));if(!p||!h)var f=Object.getOwnPropertyDescriptor}if(!Object.getOwnPropertyDescriptor||f){var m="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(t,e){if(l(t))throw new TypeError(m+t);if(f)try{return f.call(Object,t,e)}catch(o){}var c;if(!s(t,e))return c;if(c={enumerable:a(t,e),configurable:!0},u){var d=t.__proto__,h=t!==r;h&&(t.__proto__=r);var p=n(t,e),v=i(t,e);if(h&&(t.__proto__=d),p||v)return p&&(c.get=p),v&&(c.set=v),c}return c.value=t[e],c.writable=!0,c}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)}),!Object.create){var v,_=!({__proto__:null}instanceof Object),g=function(){if(!document.domain)return!1;try{return!!new ActiveXObject("htmlfile")}catch(t){return!1}},y=function(){var t,e;e=new ActiveXObject("htmlfile");var n="script";return e.write("<"+n+"></"+n+">"),e.close(),t=e.parentWindow.Object.prototype,e=null,t},b=function(){var t,e=document.createElement("iframe"),n=document.body||document.documentElement;return e.style.display="none",n.appendChild(e),e.src="javascript:",t=e.contentWindow.Object.prototype,n.removeChild(e),e=null,t};v=_||"undefined"==typeof document?function(){return{__proto__:null}}:function(){var t=g()?y():b();delete t.constructor,delete t.hasOwnProperty,delete t.propertyIsEnumerable,delete t.isPrototypeOf,delete t.toLocaleString,delete t.toString,delete t.valueOf;var e=function(){};return e.prototype=t,v=function(){return new e},new e},Object.create=function(t,e){var n,i=function(){};if(null===t)n=v();else{if(null!==t&&l(t))throw new TypeError("Object prototype may only be an Object or null");i.prototype=t,n=new i,n.__proto__=t}return void 0!==e&&Object.defineProperties(n,e),n}}var C=function(t){try{return Object.defineProperty(t,"sentinel",{}),"sentinel"in t}catch(e){return!1}};if(Object.defineProperty){var T=C({}),S="undefined"==typeof document||C(document.createElement("div"));if(!T||!S)var A=Object.defineProperty,E=Object.defineProperties}if(!Object.defineProperty||A){var O="Property description must be an object: ",w="Object.defineProperty called on non-object: ",I="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(o,s,a){if(l(o))throw new TypeError(w+o);if(l(a))throw new TypeError(O+a);if(A)try{return A.call(Object,o,s,a)}catch(c){}if("value"in a)if(u&&(n(o,s)||i(o,s))){var d=o.__proto__;o.__proto__=r,delete o[s],o[s]=a.value,o.__proto__=d}else o[s]=a.value;else{var h="get"in a,p="set"in a;if(!u&&(h||p))throw new TypeError(I);h&&t(o,s,a.get),p&&e(o,s,a.set)}return o}}Object.defineProperties&&!E||(Object.defineProperties=function(t,e){if(E)try{return E.call(Object,t,e)}catch(n){}return Object.keys(e).forEach(function(n){"__proto__"!==n&&Object.defineProperty(t,n,e[n])}),t}),Object.seal||(Object.seal=function(t){if(Object(t)!==t)throw new TypeError("Object.seal can only be called on Objects.");return t}),Object.freeze||(Object.freeze=function(t){if(Object(t)!==t)throw new TypeError("Object.freeze can only be called on Objects.");return t});try{Object.freeze(function(){})}catch(M){Object.freeze=function(t){return function(e){return"function"==typeof e?e:t(e)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(t){if(Object(t)!==t)throw new TypeError("Object.preventExtensions can only be called on Objects.");return t}),Object.isSealed||(Object.isSealed=function(t){if(Object(t)!==t)throw new TypeError("Object.isSealed can only be called on Objects.");return!1}),Object.isFrozen||(Object.isFrozen=function(t){if(Object(t)!==t)throw new TypeError("Object.isFrozen can only be called on Objects.");return!1}),Object.isExtensible||(Object.isExtensible=function(t){if(Object(t)!==t)throw new TypeError("Object.isExtensible can only be called on Objects.");for(var e="";s(t,e);)e+="?";t[e]=!0;var n=s(t,e);return delete t[e],n})})},26:function(t,e){},35:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var o=n(9),r=n(2),s=r.info.nrtcVersion,a="https://statistic.live.126.net/statistic/realtime/sdkFunctioninfo",c=function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,l);var e=t.appkey,n=t.platform;this.apis={},this.isRtc=/WebRTC/.test(n),this.init(e,n),this.resetStatus()};e["default"]=c;var u=c.prototype;u.init=function(t,e){this.apis=Object.assign(this.apis,{ver:1,platform:e,sdk_ver:s||"v4.4.0",uid:null,appkey:t,time:null})},u.start=function(t){this.calling=!0,this.apis=Object.assign(this.apis,t)},u.resetStatus=function(){this.calling=!1,this.apis=Object.assign(this.apis,{p2p:{value:0},meeting:{value:0},bypass:{value:0},call_control_type:{value:0},self_mute:{value:-1},self_mic_mute:{value:-1},switch_p2p_type:{value:0},set_speaker:{value:-1},net_detect:{value:this.isRtc?-1:0},beautify:{value:-1},water_mark:{value:-1},audio_samples:{value:-1},video_samples:{value:-1},pre_view_mirror:{value:-1},code_mirror:{value:-1},custom_audio:{value:-1},custom_video:{value:-1},audio_mix:{value:-1},snap_shot:{value:-1},record:{value:0},audio_record:{value:0},display:{value:0},android_compatibility:{value:-1},hd_audio:{value:0},video_quality:{value:0},fps:{value:0},prefered_video_encoder:{value:-1},prefered_video_decoder:{value:-1},video_max_encode_bitrate:{value:this.isRtc?-1:0},audio_scene:{value:-1},video_adaptive_strategy:{value:this.isRtc?-1:0},ans:{value:this.isRtc?-1:0},agc:{value:-1},dtx:{value:-1},aec:{value:this.isRtc?-1:0},awc:{value:this.isRtc?-1:0}})},u.update=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],n=t.key,i=t.ext;t.constructor===String&&(n=t),i=i||e,this.apis[n]&&(this.apis[n].value=1,void 0!==i&&(this.apis[n].ext=i),/(p2p|meeting)/.test(n)&&(this.calling=!0))},u.send=function(){var t=this;this.calling&&(this.calling=!1,this.apis.time=Date.now(),(0,o.ajax)({type:"post",url:a,data:this.apis}).then(function(e){t.resetStatus()})["catch"](function(e){
console.log("err",e),t.resetStatus()}))},t.exports=e["default"]},38:function(t,e){"use strict";e.__esModule=!0,e["default"]=function(t){if(!t.url||!t.data)return Promise.reject("参数不完整，无法发起请求");t.dataType=t.dataType||"json";var e=new XMLHttpRequest;return e.open(t.type||"GET",t.url,!0),e.responseType=""+t.dataType,e.setRequestHeader("Content-type","application/json;charset=UTF-8"),t.header&&Object.keys(t.header).map(function(n){e.setRequestHeader(n,t.header[n])}),new Promise(function(n,i){e.onload=function(){var t=e.response;n(t)},e.onerror=function(t){i(t)},e.send(JSON.stringify(t.data))})};t.exports=e["default"]},39:function(t,e){"use strict";e.__esModule=!0,e["default"]={merge:function(){var t=arguments;return t[0]=Object.assign.apply(Object.assign,arguments),t[0]},verifyOptions:function(){var t=arguments;if(t[0]&&t[0].constructor===Object)for(var e=1;e<arguments.length;e++){var n=t[e];n=n.split(" "),n.map(function(e){if(!t[0][e])throw Error("参数缺失 "+e)})}},guid:function(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return function(){return t()+t()+t()+t()+t()+t()+t()+t()}}()},t.exports=e["default"]},41:function(t,e,n){"use strict";function i(t,e){for(var n in e)t[n]=e[n];return t}n(25),n(11),n(3).Promise,window.Object.assign||(console.log("Object.assign polyfill"),window.Object.assign=function(){for(var t=arguments,e=1;e<t.length;e++)t[0]=i(t[0],t[e]);return t[0]})},47:function(t,e){"use strict";e.__esModule=!0,e["default"]={html2node:function(t){var e=document.createElement("div");e.innerHTML=t;var n,i,o=[];if(e.children)for(n=0,i=e.children.length;n<i;n++)o.push(e.children[n]);else for(n=0,i=e.childNodes.length;n<i;n++){var r=e.childNodes[n];1===r.nodeType&&o.push(r)}return o.length>1?e:o[0]},n2node:function(t){return t?/HTML.+Element/gi.test(t)?t:t[0]&&/HTML.+Element/gi.test(t[0])?t[0]:null:null}},t.exports=e["default"]},66:function(t,e){function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}},68:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(35),r=i(o),s=n(89),a=i(s),c=n(90),u=i(c);e["default"]={DataApi:function(t){return new r["default"](t)},DataRtc:function(t){return new a["default"](t)},DataStats:function(t){return new u["default"](t)}},t.exports=e["default"]},79:function(t,e){"use strict";function n(t){i(t.enable)&&(this.enable=t.enable?1:0),i(t.needBadge)&&(this.needBadge=t.needBadge?1:0),i(t.needPushNick)&&(this.needPushNick=t.needPushNick?1:0),i(t.pushContent)&&(this.pushContent=""+t.pushContent),i(t.custom)&&(this.custom=""+t.custom),i(t.pushPayload)&&(this.pushPayload=""+t.pushPayload),i(t.sound)&&(this.sound=""+t.sound),i(t.webrtcEnable)&&(this.webrtcEnable=t.webrtcEnable?1:0)}e.__esModule=!0,e["default"]=function(t){var e=t.util;return i=e.notundef,n};var i=void 0;t.exports=e["default"]},89:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var o=n(9),r=n(2),s=r.info.nrtcVersion,a="https://statistic.live.126.net/statistic/realtime/sdkinfo",c=function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,d);var e=t.appkey;this.infos={},this.userlist=[],this.localVolumn=0,this.local={},this.remote={},this.init(e),this.resetStatus()};e["default"]=c;var u=c.prototype;u.init=function(t){this.infos=Object.assign(this.infos,{ver:1,device:-1,isp:-1,platform:l.convertPlatform(platform.os.family)+"-"+platform.os.version,browser:platform.name+"-"+platform.version,sdk_ver:s||"3.6.0",appkey:t,interval:60,samples:30,time:null,qos_algorithm:-1,fec_algorithm:-1,qos_scene:-1,qos_strategy:-1})},u.resetStatus=function(){this.infos=Object.assign(this.infos,{uid:null,cid:null,push_url:null,turn_ip:null,proxy_ip:null,meeting:!1,live:!1}),this.clearInfoData(),this.uidSsrcMap={},this.userlist=[]},u.initInfoData=function(t){var e={uid:t,cid:this.imInfo&&this.imInfo.channelId||-1,push_url:this.sessionConfig&&this.sessionConfig.rtmpUrl||-1,turn_ip:this.imInfo&&this.imInfo.turnMap||-1,proxy_ip:this.imInfo&&this.imInfo.turnMap||-1,meeting:/^meeting$/gi.test(this.imInfo.sessionMode),live:this.sessionConfig&&this.sessionConfig.liveEnable||!1,p2p:!1,isp:-1,net:-1,connect_state:this.imInfo&&this.imInfo.code||200,signalling_time:(this.sessionConfig&&this.sessionConfig.signalEndTime||0)-(this.sessionConfig&&this.sessionConfig.signalStartTime||0),connect_time:(this.sessionConfig&&this.sessionConfig.rtcEndTime||0)-(this.sessionConfig&&this.sessionConfig.rtcStartTime||0)};this.infos=Object.assign(this.infos,e)},u.clearInfoData=function(){this.localVolumn=0,this.infos=Object.assign(this.infos,{rx:{audio:[],video:[]},tx:{a_lost:[],v_lost:[],rtt:[],rtt_mdev:[],set_v_fps:[],qos_v_fps:[],v_fps:[],set_v_quality:[],real_v_res:[],real_v_kbps:[],real_v_kbps_n:[],real_a_kbps:[],real_a_kbps_n:[],set_v_kbps:[],qos_v_kbps:[],tx_bw_kbps:[],a_volume:[]}})},u.start=function(t){var e=this,n=t.info,i=t.imInfo,o=t.remoteUidMsidMap,r=t.sessionConfig,s=t.rtcConnection,a=t.uid;i&&o&&s&&(this.infos.appkey=n.appKey||n.appkey||this.infos.appkey,this.imInfo=i||{},this.remoteUidMsidMap=o||{},this.sessionConfig=r||{},this.rtcConnection=s,this.videoConfig=t.videoConfig||{},this.statsTimer||(this.getTurnMap(),this.initInfoData(a),this.format(),this.statsTimer=setInterval(function(){e.sendInfo()},1e3*this.infos.interval)))},u.stop=function(){this.statsTimer&&(clearInterval(this.statsTimer),this.statsTimer=null,this.resetStatus())},u.update=function(t){this.rtcStats=t,this.format(),this.updateRxMediaInfo(),this.updateTxMediaInfo()},u.updateOnce=function(t){var e=t.imInfo,n=t.remoteUidMsidMap,i=t.sessionConfig,o=t.rtcConnection;e&&(this.imInfo=e||{},this.remoteUidMsidMap=n||{},this.sessionConfig=i||{},this.rtcConnection=o||{},this.videoConfig=t.videoConfig||{},this.getTurnMap(),this.initInfoData(),this.sendInfo())},u.updateLocalVolumn=function(t){this.localVolumn=t},u.updateRxMediaInfo=function(){var t=this,e={u:[],g:[],c:[],bn:[],bc:[]},n={u:[],i:[],bn:[],bc:[],r:[],f:[]};this.userlist.map(function(i){var o=t.getMediaStats(i);e.u.push(o.audio.u),e.g.push(-1),e.c.push(-1),e.bn.push(o.audio.bn),e.bc.push(o.audio.bc),n.u.push(o.video.u),n.i.push(o.video.i),n.bn.push(o.video.bn),n.bc.push(o.video.bc),n.r.push(o.video.r),n.f.push(o.video.f)}),this.infos.rx.audio.push(e),this.infos.rx.video.push(n)},u.getMediaStats=function(t){var e=this.rtcStats,n={audio:{u:+t,g:-1,c:-1,bn:0,bc:0},video:{u:+t,i:-1,bn:0,bc:0,r:-1,f:0}},i={},o=this.uidSsrcMap[t];if(!o)return n;o=o.join("|");var r=new RegExp("("+o+")");return e.results.filter(function(t){return r.test(t.ssrc)&&(i[t.mediaType]=t),r.test(t)}),i.audio&&(n.audio.bn=(i.audio.availableBandwidth||0)-0,n.audio.bc=-1),i.video&&(n.video.bn=(i.video.availableBandwidth||0)-0,n.video.bc=i.video.googFrameWidthReceived+"x"+i.video.googFrameHeightReceived,n.video.f=(i.video.googFrameRateDecoded||0)-0),n},u.getLocalMediaStats=function(){var t=this.rtcStats,e={a_lost:-1,v_lost:-1,rtt:0,rtt_mdev:-1,set_v_fps:this.videoConfig.frameRate||0,qos_v_fps:0,v_fps:0,set_v_quality:this.sessionConfig.videoQuality,real_v_res:0,real_v_kbps:0,real_v_kbps_n:0,real_a_kbps:-1,real_a_kbps_n:0,set_v_kbps:-1,qos_v_kbps:0,tx_bw_kbps:0,a_volume:0},n={},i=this.imInfo.uid,o=this.uidSsrcMap[i];if(!o)return e;o=o.join("|");var r=new RegExp("("+o+")");return t.results.filter(function(t){return t.localCandidateId?void(n.rtt=t):(r.test(t.ssrc)&&(n[t.mediaType]=t),r.test(t))}),n.audio&&(e.real_a_kbps_n=(n.audio.availableBandwidth||t.audio.send.availableBandwidth)-0,e.a_volume=this.localVolumn-0),n.video&&(e.qos_v_fps=n.video.googFrameRateInput-0,e.v_fps=n.video.googFrameRateSent-0,e.real_v_res=n.video.googFrameWidthSent+"x"+n.video.googFrameHeightSent,e.real_v_kbps=n.video.googEncodeUsagePercent-0,e.real_v_kbps_n=n.video.availableBandwidth-0),e.rtt=n.rtt.googRtt-0,e.tx_bw_kbps=(t.connectionType.bitsSentPerSecond||0)-0,e},u.updateTxMediaInfo=function(){var t=this.getLocalMediaStats(),e=this.infos.tx;for(var n in t)e[n].push(t[n]);this.infos.net=l.convertNetwork(this.rtcStats.connectionType.local.networkType[0])},u.getTurnMap=function(){var t=this.imInfo;t.serverMap&&(t.turnMap=JSON.parse(t.serverMap||null),t.turnMap=t.turnMap&&t.turnMap.turnaddrs,t.turnMap=t.turnMap&&t.turnMap[0],t.turnMap=t.turnMap.constructor===Array?t.turnMap[0]:t.turnMap,t.turnMap=t.turnMap&&t.turnMap.match(/\d+\.\d+.\d+\.\d+/),t.turnMap=t.turnMap[0])},u.getSsrc=function(t,e){var n=[],i={audio:this.getTypeSsrc("audio",t,e),video:this.getTypeSsrc("video",t,e)};return i.audio&&n.push(i.audio),i.video&&n.push(i.video),n},u.getTypeSsrc=function(t,e,n){var i=void 0,o="";if(i=new RegExp(t+"[.\\r\\n\\s\\S]*ssrc:(\\d+)\\smsid:"+e),o=n.match(i),o=o&&o[0])return i=new RegExp("ssrc:\\d+\\smsid:"+e),o=o.match(i),o=o.map(function(t){return i=new RegExp("ssrc:(\\d+)\\s"),t=t.match(i),t[1]})},u.format=function(){this.formatLocal(),this.formatRemote()},u.formatLocal=function(){this.localSdp=this.rtcConnection.localDescription,this.localStream=this.rtcConnection.getLocalStreams()[0],this.localStream&&(this.uidSsrcMap[this.imInfo.uid]=this.getSsrc(this.localStream.id,this.localSdp.sdp),this.local.ssrc=this.uidSsrcMap[this.imInfo.uid])},u.formatRemote=function(){this.remoteSdp=this.rtcConnection.remoteDescription,this.userlist=[];var t=this.remoteUidMsidMap;for(var e in t)this.userlist.push(e),this.remote[e]={},this.uidSsrcMap[e]=this.getSsrc(t[e],this.remoteSdp.sdp),this.remote[e].ssrc=this.uidSsrcMap[e]},u.sendInfo=function(){var t=this;this.infos.uid&&this.infos.cid&&(this.infos.time=Date.now(),this.infos.samples=this.infos.rx.audio.length,(0,o.ajax)({type:"post",url:a,data:this.infos}).then(function(e){t.clearInfoData()})["catch"](function(e){t.clearInfoData()}))};var l={convertNetwork:function(t){var e={wlan:"wifi",lan:"ethernet"};return e[t]||"unknown"},convertPlatform:function(t){var e=/Windows/i,n=/OS X/i,i=void 0;return i=e.test(t)&&"Win"||t,i=n.test(i)&&"Mac"||i}};t.exports=e["default"]},90:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var o=n(9),r=n(2),s=r.info.nrtcVersion,a="//statistic.live.126.net/webrtc/stat",c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var n=e.appkey;this.infos={},this.init(n),this.resetStatus()}return t.prototype.resetStatus=function(){},t.prototype.init=function(t){this.infos=Object.assign(this.infos,{interval:30,ver:1,platform:u.convertPlatform(platform.os.family)+"-"+platform.os.version,browser:platform.name+"-"+platform.version,sdk_ver:s||"3.6.0",uid:null,appkey:t,time:null,data:{}})},t.prototype.clear=function(){this.infos.data={}},t.prototype.start=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.infos.appkey=t.appKey||t.appkey||this.infos.appkey,this.infos.cid=t.cid,this.infos.uid=t.uid},t.prototype.stop=function(){this.clear()},t.prototype.update=function(t){this.infos.data["stat_"+Date.now()]=t,Object.keys(this.infos.data).length===this.infos.interval&&this.send()},t.prototype.send=function(){var t=this;0!==Object.keys(this.infos.data).length&&(this.infos.time=Date.now(),(0,o.ajax)({type:"post",url:a,data:this.infos}).then(function(e){t.clear()})["catch"](function(t){console.log("err",t)}))},t}();e["default"]=c;var u={convertNetwork:function(t){var e={wlan:"wifi",lan:"ethernet"};return e[t]||"unknown"},convertPlatform:function(t){var e=/Windows/i,n=/OS X/i,i=void 0;return i=e.test(t)&&"Win"||t,i=n.test(i)&&"Mac"||i}};t.exports=e["default"]},115:function(t,e){"use strict";e.__esModule=!0;var n,i,o={NETCALL_TYPE_AUDIO:1,NETCALL_TYPE_VIDEO:2,NETCALL_CONTROL_COMMAND_NOTIFY_AUDIO_ON:1,NETCALL_CONTROL_COMMAND_NOTIFY_AUDIO_OFF:2,NETCALL_CONTROL_COMMAND_NOTIFY_VIDEO_ON:3,NETCALL_CONTROL_COMMAND_NOTIFY_VIDEO_OFF:4,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO:5,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_AGREE:6,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_REJECT:7,NETCALL_CONTROL_COMMAND_SWITCH_VIDEO_TO_AUDIO:8,NETCALL_CONTROL_COMMAND_BUSY:9,NETCALL_CONTROL_COMMAND_SELF_CAMERA_INVALID:10,NETCALL_CONTROL_COMMAND_SELF_AUDIO_INVALID:11,NETCALL_CONTROL_COMMAND_SELF_ON_BACKGROUND:12,NETCALL_CONTROL_COMMAND_START_NOTIFY_RECEIVED:13,NETCALL_CONTROL_COMMAND_NOTIFY_RECORD_START:14,NETCALL_CONTROL_COMMAND_NOTIFY_RECORD_STOP:15,DEVICE_TYPE_AUDIO_IN:0,DEVICE_TYPE_AUDIO_OUT_LOCAL:1,DEVICE_TYPE_AUDIO_OUT_CHAT:2,DEVICE_TYPE_VIDEO:3,DEVICE_STATUS_NO_CHANGE:0,DEVICE_STATUS_CHANGE:1,DEVICE_STATUS_WORK_REMOVE:2,DEVICE_STATUS_RESET:4,DEVICE_STATUS_START:8,DEVICE_STATUS_END:16,CHAT_VIDEO_QUALITY_NORMAL:0,CHAT_VIDEO_QUALITY_LOW:1,CHAT_VIDEO_QUALITY_MEDIUM:2,CHAT_VIDEO_QUALITY_HIGH:3,CHAT_VIDEO_QUALITY_480P:4,CHAT_VIDEO_QUALITY_720P:5,CHAT_VIDEO_QUALITY_540P:6,CHAT_VIDEO_ENCODEMODE_NORMAL:0,CHAT_VIDEO_ENCODEMODE_SMOOTH:1,CHAT_VIDEO_ENCODEMODE_QUALITY:2,CHAT_VIDEO_ENCODEMODE_SCREEN:3,CHAT_VIDEO_FRAME_RATE_NORMAL:0,CHAT_VIDEO_FRAME_RATE_5:1,CHAT_VIDEO_FRAME_RATE_10:2,CHAT_VIDEO_FRAME_RATE_15:3,CHAT_VIDEO_FRAME_RATE_20:4,CHAT_VIDEO_FRAME_RATE_25:5,CHAT_VIDEO_SCALE_None:0,CHAT_VIDEO_SCALE_1x1:1,CHAT_VIDEO_SCALE_4x3:2,CHAT_VIDEO_SCALE_16x9:3,CHAT_USER_LEFT_TIMEOUT:-1,CHAT_USER_LEFT_NORMAL:0,CHAT_NET_STATUS_VERY_GOOD:0,CHAT_NET_STATUS_GOOD:1,CHAT_NET_STATUS_POOR:2,CHAT_NET_STATUS_BAD:3,CHAT_NET_STATUS_VERY_BAD:4,CHAT_NET_STATUS_VERY_BAD_VIDEO_CLOSE:-1,CLIENT_TYPE_AOS:1,CLIENT_TYPE_IOS:2,CLIENT_TYPE_PC:4,CLIENT_TYPE_WINPHONE:8,CLIENT_TYPE_WEB:16,CLIENT_TYPE_REST:32,LAYOUT_SPLITBOTTOMHORFLOATING:0,LAYOUT_SPLITTOPHORFLOATING:1,LAYOUT_SPLITLATTICETILE:2,LAYOUT_SPLITLATTICECUTTINGTILE:3,LAYOUT_SPLITCUSTOMLAYOUT:4,LAYOUT_SPLITAUDIOLAYOUT:5,NETDETECT_AUDIO:0,NETDETECT_VIDEO:1};o.deviceTypeMap=(n={},n[o.DEVICE_TYPE_AUDIO_IN]="audioIn",n[o.DEVICE_TYPE_AUDIO_OUT_CHAT]="audioOut",n[o.DEVICE_TYPE_VIDEO]="video",n),o.getDeviceTypeStr=function(t){return o.deviceTypeMap[t]},o.deviceStatusMap=(i={},i[o.DEVICE_STATUS_NO_CHANGE]="noChange",i[o.DEVICE_STATUS_CHANGE]="change",i[o.DEVICE_STATUS_WORK_REMOVE]="workRemove",i[o.DEVICE_STATUS_RESET]="reset",i[o.DEVICE_STATUS_START]="start",i[o.DEVICE_STATUS_END]="end",i),o.getDeviceStatusStr=function(t){return o.deviceStatusMap[t]},e["default"]=o,t.exports=e["default"]},133:function(t,e,n){"use strict";var i=n(79),o={};o.install=function(t){var e=t.fn,n=t.util,o=i({util:n});e.initNetcall=function(t){return n.verifyOptions(t,"type accounts","netcall::initNetcall"),t.pushContent="",t.custom="",t.pushConfig||(t.pushConfig={}),t.pushConfig.webrtcEnable=t.webrtcEnable,t.pushConfig=new o(t.pushConfig),this.cbAndSendCmd("initNetcall",t)},e.keepCalling=function(t){return n.verifyOptions(t,"type accounts channelId","netcall::keepCalling"),this.cbAndSendCmd("keepCalling",t)},e.calleeAck=function(t){return n.verifyOptions(t,"account channelId type accepted","netcall::calleeAck"),this.cbAndSendCmd("calleeAck",t)},e.hangup=function(t){return n.verifyOptions(t,"channelId","netcall::hangup"),this.cbAndSendCmd("hangup",t)},e.netcallControl=function(t){return n.verifyOptions(t,"channelId type","netcall::netcallControl"),this.cbAndSendCmd("netcallControl",t)},e.createChannel=function(t){return this.cbAndSendCmd("createChannel",t)},e.joinChannel=function(t){return n.verifyOptions(t,"channelName","netcall::joinChannel"),n.verifyBooleanWithDefault(t,"liveEnable",!1,"","netcall::joinChannel"),n.verifyBooleanWithDefault(t,"webrtcEnable",!1,"","netcall::joinChannel"),this.cbAndSendCmd("joinChannel",{channelName:t.channelName,liveOption:{liveEnable:t.liveEnable?1:0,webrtcEnable:t.webrtcEnable?1:0}})},e.queryAccountUidMap=function(t,e){return this.cbAndSendCmd("queryAccountUidMap",{channelName:t,uids:e})}},t.exports=o},190:function(t,e){"use strict";var n={};n.install=function(t){var e=t.Protocol.fn;e.processNetcall=function(t){switch(t.cmd){case"initNetcall":this.onInitNetcall(t);break;case"beCalled":this.onBeCalled(t);break;case"keepCalling":this.onKeepCalling(t);break;case"calleeAck":break;case"notifyCalleeAck":this.onNotifyCalleeAck(t);break;case"hangup":break;case"notifyHangup":this.onNotifyHangup(t);break;case"notifyNetcallControl":this.onNetcallControl(t);break;case"notifyCalleeAckSync":this.onNotifyCalleeAckSync(t);break;case"notifyNetcallRecord":this.onMsg(t);break;case"createChannel":break;case"joinChannel":this.joinChannel(t);break;case"notifyJoin":this.notifyJoin(t)}},e.onInitNetcall=function(t){if(!t.error){var e=t.obj.type;t.obj=t.content,t.obj.type=e,t.obj.accounts=t.obj.keepCallingAccounts,this.setCurrentNetcall(t.obj.channelId),this.keepCalling(t)}},e.setCurrentNetcall=function(t){this.currentNetcallChannelId=t},e.onKeepCalling=function(t){t.error||t.content.accounts.length&&this.keepCalling(t)},e.keepCalling=function(t){var e=this,n=t.obj,i=n.type,o=n.accounts,r=n.channelId;o&&o.length&&setTimeout(function(){e.currentNetcallChannelId&&e.currentNetcallChannelId===r&&e.api.keepCalling({type:i,accounts:o,channelId:r})["catch"](function(){})},3e3)},e.onBeCalled=function(t){t.error||this.emitAPI({type:"beCalled",obj:t.content})},e.onNotifyCalleeAck=function(t){t.error||this.emitAPI({type:"notifyCalleeAck",obj:t.content})},e.onNotifyHangup=function(t){t.error||this.emitAPI({type:"notifyHangup",obj:t.content})},e.onNetcallControl=function(t){t.error||this.emitAPI({type:"netcallControl",obj:t.content})},e.onNotifyCalleeAckSync=function(t){t.error||this.emitAPI({type:"notifyCalleeAckSync",obj:t.content})},e.notifyJoin=function(t){t.error||this.emitAPI({type:"notifyJoin",obj:t.content})},e.joinChannel=function(t){t.obj=t.content}},t.exports=n},199:function(t,e){"use strict";var n=9,i={netcall:{id:n,initNetcall:1,keepCalling:3,calleeAck:4,notifyCalleeAck:5,hangup:6,notifyHangup:7,netcallControl:8,notifyNetcallControl:9,verifyChannelId:10,createChannel:13,joinChannel:14,queryAccountUidMap:16}},o={initNetcall:{sid:n,cid:i.netcall.initNetcall,params:[{type:"byte",name:"type"},{type:"StrArray",name:"accounts"},{type:"String",name:"pushContent"},{type:"String",name:"custom"},{type:"Property",name:"pushConfig"}]},keepCalling:{sid:n,cid:i.netcall.keepCalling,params:[{type:"byte",name:"type"},{type:"StrArray",name:"accounts"},{type:"long",name:"channelId"}]},calleeAck:{sid:n,cid:i.netcall.calleeAck,params:[{type:"string",name:"account"},{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"bool",name:"accepted"}]},hangup:{sid:n,cid:i.netcall.hangup,params:[{type:"long",name:"channelId"}]},netcallControl:{sid:n,cid:i.netcall.netcallControl,params:[{type:"long",name:"channelId"},{type:"byte",name:"type"}]},verifyChannelId:{sid:n,cid:i.netcall.verifyChannelId,params:[{type:"long",name:"channelId"},{type:"String",name:"account"}]},createChannel:{sid:n,cid:i.netcall.createChannel,params:[{type:"String",name:"channelName"},{type:"String",name:"custom"},{type:"String",name:"webrtcEnable"}]},joinChannel:{sid:n,cid:i.netcall.joinChannel,params:[{type:"String",name:"channelName"},{type:"Property",name:"liveOption"}]},queryAccountUidMap:{sid:n,cid:i.netcall.queryAccountUidMap,params:[{type:"String",name:"channelName"},{type:"LongArray",name:"uids"}]}},r="netcall",s={"9_1":{service:r,cmd:"initNetcall",response:[{type:"Number",name:"timetag"},{type:"Number",name:"uid"},{type:"Number",name:"channelId"},{type:"StrArray",name:"turnServerList"},{type:"StrArray",name:"sturnServerList"},{type:"StrArray",name:"proxyServerList"},{type:"StrArray",name:"keepCallingAccounts"},{type:"StrLongMap",name:"accountUidMap"},{type:"String",name:"clientConfig"},{type:"String",name:"serverMap"}]},"9_2":{service:r,cmd:"beCalled",response:[{type:"Number",name:"timetag"},{type:"Number",name:"type"},{type:"Number",name:"channelId"},{type:"String",name:"account"},{type:"Number",name:"uid"},{type:"StrArray",name:"turnServerList"},{type:"StrArray",name:"sturnServerList"},{type:"StrArray",name:"proxyServerList"},{type:"StrLongMap",name:"accountUidMap"},{type:"String",name:"clientConfig"},{type:"String",name:"custom"},{type:"Property",name:"pushConfig"},{type:"String",name:"serverMap"}]},"9_3":{service:r,cmd:"keepCalling",response:[{type:"StrArr",name:"accounts"}]},"9_4":{service:r,cmd:"calleeAck",response:[]},"9_5":{service:r,cmd:"notifyCalleeAck",response:[{type:"String",name:"account"},{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"bool",name:"accepted"}]},"9_6":{service:r,cmd:"hangup",response:[]},"9_7":{service:r,cmd:"notifyHangup",response:[{type:"long",name:"channelId"},{type:"String",name:"account"},{type:"long",name:"timetag"}]},"9_8":{service:r,cmd:"netcallControl",response:[]},"9_9":{service:r,cmd:"notifyNetcallControl",response:[{type:"String",name:"account"},{type:"byte",name:"type"},{type:"long",name:"channelId"}]},"9_10":{service:r,cmd:"verifyChannelId",response:[]},"9_11":{service:r,cmd:"notifyNetcallRecord",response:[{type:"Property",name:"msg"}]},"9_12":{service:r,cmd:"notifyCalleeAckSync",response:[{type:"String",name:"timetag"},{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"bool",name:"accepted"},{type:"byte",name:"fromClientType"}]},"9_13":{service:r,cmd:"createChannel",response:[{type:"long",name:"timetag"}]},"9_14":{service:r,cmd:"joinChannel",response:[{type:"long",name:"timetag"},{type:"long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"},{type:"String",name:"serverMap"},{type:"String",name:"clientConfig"},{type:"String",name:"custom"}]},"9_15":{service:r,cmd:"notifyJoin",response:[{type:"Long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"}]},"9_16":{service:r,cmd:"queryAccountUidMap",response:[]}};t.exports={idMap:i,cmdConfig:o,packetConfig:s}},200:function(t,e){"use strict";t.exports={pushConfig:{enable:1,needBadge:2,needPushNick:3,pushContent:4,custom:5,pushPayload:6,sound:7,webrtcEnable:10},liveOption:{liveEnable:1,webrtcEnable:2}}},201:function(t,e){"use strict";t.exports={pushConfig:{1:"enable",2:"needBadge",3:"needPushNick",4:"pushContent",5:"custom",6:"pushPayload",7:"sound",10:"webrtcEnable"},liveOption:{1:"liveEnable",2:"webrtcEnable"}}},235:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},c=n(9),u=n(68),l=n(244),d=i(l),h=void 0,p=void 0,f=n(4),m=n(246),v=n(2),_=n(247),g=n(248),y=n(236),b=n(115),C=v.agentVersion,T=function(t){function e(n){o(this,e);var i=r(this,t.call(this));return n.container=c.element.n2node(n.container),n.remoteContainer=c.element.n2node(n.remoteContainer),i.setUtil(h),h.undef(n.heartbeat)&&(n.heartbeat=!0),h.merge(i,n),i.init(),i}return s(e,t),e}(f);T.install=function(t){h=t.util,p=t.Promise,_.install(t),g.install(t),y.install(t)};var S=T.prototype;S.init=function(){this.signal=null,this.signalInited=!1,this.localStreamInfo=null,this.resetStatus(),this.initProtocol(),this.dataApi=(0,u.DataApi)({appkey:this.nim.options.appKey,platform:"PC-Agent"})},S.resetStatus=function(){this.channelId=null,this.channelName=null,this.type=null,this.target=null,this.sessionMode=null,this.sessionConfig={},this.isCaller=!1,this.callee=null,this.remoteStreamInfo={},this.calling=!1,this.callAccepted=!1,this.callerInfo=null,this.nim.protocol.setCurrentNetcall(),this.needQueryAccountMap={}},S.initProtocol=function(){var t=this.nim;this.account=this.nim.account,t.on("beCalled",this.onBeCalled.bind(this)),t.on("notifyCalleeAck",this.onCalleeAck.bind(this)),t.on("notifyHangup",this.onHangup.bind(this)),t.on("notifyUploadLog",this.uploadLog.bind(this)),t.on("netcallControl",this.onNetcallControl.bind(this)),t.on("notifyCalleeAckSync",this.onCalleeAckSync.bind(this)),t.on("notifyJoin",this.onNotifyJoin.bind(this))},S.getAccount=function(){return this.nim.account},S.getUid=function(){return this.accountUidMap?this.accountUidMap[this.nim.account]||"-1":"-1"},S.isCurrentChannelId=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.channelId&&this.channelId===t.channelId},S.notCurrentChannelId=function(t){return!this.isCurrentChannelId(t)},S.rejectWithNoSignal=function(){return this.resetWhenHangup(),p.reject({code:"noConnection"})},S.initSignal=function(){var t=this;return this.signal?this.stopSignal().then(function(){return t._initSignal()}):this._initSignal()},S._initSignal=function(){var t=this;return new p(function(e,n){var i=t.signal=new _({url:m.signalUrl,client:t,kickLast:t.kickLast,account:t.getAccount(),heartbeat:t.heartbeat,appkey:t.nim.options.appKey});i.on("init",function(i){return t.log(i),t.checkAgentVersion(i.version)?(t.localStreamInfo=i,t.signalInited=!0,void e()):(t.log("插件版本有更新，请下载最新的插件再使用音视频功能"),t.stopSignal(),i.error="请安装最新版插件，方可使用视频功能",i.errorType="agent_update",void n(i))}),i.on("initError",function(e){t.log(e),e=e||{},417===e.code&&(e.error="设备被别的程序占用中, 请检查重试",e.errorType="device_busy"),"noPC"===e.code&&(e.error="请安装插件PC Agent，方可使用音视频功能",e.errorType="agent_empty"),n(e),t.rejectWithNoSignal()}),i.on("close",function(){t.emit("signalClosed"),t.stopSignal()}),i.on("devices",function(e){t.emit("devices",e)}),i.on("login",function(e){t.emit("sessionStarted",e)}),i.on("deviceStatus",function(e){t.emit("deviceStatus",e)}),i.on("userJoined",t.onUserJoin.bind(t)),i.on("userLeft",t.onUserLeft.bind(t)),i.on("logUploaded",t.onLogUploaded.bind(t)),i.on("netStatus",function(e){var n=e.id,i=e.status;t.emit("netStatus",{account:t.getAccountWithUid(n),status:i})}),i.on("statistics",function(e){t.emit("statistics",e)}),i.on("audioVolume",function(e){var n=e.self,i=e.receiver,o={self:n};i&&i.forEach(function(e){var n=e.id,i=e.status;o[t.getAccountWithUid(n)]={status:i}}),t.emit("audioVolume",o)}),i.on("error",t.onError.bind(t)),i.on("recordMp4",t.onRecordMp4.bind(t)),i.on("heartBeatError",t.onError.bind(t))})},S.checkAgentVersion=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.0.0.0",e=t.split("."),n=C.split("."),i=0;i<e.length;i++){if(+e[i]>+n[i])return!0;if(+e[i]<+n[i])return!1}return!0},S.stopSignal=function(){var t=this;return this.stopLocalStream(),this.stopRemoteStream(),this.signal?this.signal.stopSession().then(function(){t.signal.destroy(),t.signal=null,t.signalInited=!1}):p.resolve()},S.initNetcall=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.type,i=e.pushConfig;return this.type=n,this.sessionMode="p2p",this.nim.initNetcall({type:n,accounts:[this.callee],webrtcEnable:!0,pushConfig:i}).then(function(e){return t.callerInfo=e,t.channelId=e.channelId,p.resolve(e)},function(e){throw t.resetWhenHangup(),e})},S.initSession=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.signalInited){var n=this.isCaller?this.callerInfo:e.beCalledInfo;this.parseAccountUidMap(n.accountUidMap);var i=this.sessionConfig||{};return i.awc&&this.dataApi.update({key:"awc"}),i.ans&&this.dataApi.update({key:"ans"}),i.aec&&this.dataApi.update({key:"aec"}),this.signal.startSession(a({},n,i)).then(function(){return{channelId:t.channelId}})}return this.rejectWithNoSignal()},S.call=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dataApi.update("p2p"),new p(function(n,i){if(!t.signalInited||t.calling)return t.resetStatus(),i({type:"statusNotMatch",error:"呼叫失败: 当前正在通话中或者Agent唤起失败，请排查"});var o=e.account,r=e.type,s=e.pushConfig,a=e.sessionConfig,c=void 0===a?{}:a;if(t.calling=!0,t.isCaller=!0,t.callee=t.target=o,t.sessionConfig=c,c.highAudio&&t.dataApi.update("hd_audio"),void 0!==c.videoFrameRate&&t.dataApi.update("fps",0===+c.videoFrameRate?0:+c.videoFrameRate+1),void 0!==c.videoEncodeMode&&t.dataApi.update("video_adaptive_strategy",c.videoEncodeMode||0),void 0!==c.videoBitrate&&t.dataApi.update("video_max_encode_bitrate",c.videoBitrate||""),void 0!==c.videoQuality){var u=c.videoQuality;u===b.CHAT_VIDEO_QUALITY_540P?u=b.CHAT_VIDEO_QUALITY_720P:u===b.CHAT_VIDEO_QUALITY_720P&&(u=b.CHAT_VIDEO_QUALITY_540P),t.dataApi.update("video_quality",u||0)}return o?t.initNetcall({type:r,pushConfig:s}).then(function(t){n(t)})["catch"](function(t){i(t)}):(t.resetStatus(),void i({code:"noCalleeAccount"}))})},S.onBeCalled=function(t){this.log("beCalling",t),this.emit("beCalling",t)},S.response=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.dataApi.update("p2p");var n=e.beCalledInfo;if(!n)return p.resolve();var i=n.accepted=e.accepted!==!1,o=this.sessionConfig=e.sessionConfig||{};if(o.highAudio&&this.dataApi.update("hd_audio"),void 0!==o.videoFrameRate&&this.dataApi.update("fps",0===+o.videoFrameRate?0:+o.videoFrameRate+1),void 0!==o.videoEncodeMode&&this.dataApi.update("video_adaptive_strategy",o.videoEncodeMode||0),void 0!==o.videoBitrate&&this.dataApi.update("video_max_encode_bitrate",o.videoBitrate||""),void 0!==o.videoQuality){var r=o.videoQuality;r===b.CHAT_VIDEO_QUALITY_540P?r=b.CHAT_VIDEO_QUALITY_720P:r===b.CHAT_VIDEO_QUALITY_720P&&(r=b.CHAT_VIDEO_QUALITY_540P),this.dataApi.update("video_quality",r||0)}return i?(this.type=n.type,this.channelId=n.channelId,this.target=n.account,this.calling=!0):(this.log("rejectNetcall",n),this.packNetcallRecord({type:n.type,channelId:n.channelId,isCaller:!1,target:n.account,recordType:"rejectNetcall"})),this.sessionMode="p2p",this.nim.calleeAck(n).then(function(){if(i)return t.initSession({beCalledInfo:n})},function(e){throw t.log(e),e})},S.onCalleeAck=function(t){if(!this.notCurrentChannelId(t))return t.accepted?this.initSession({type:t.type}):(this.log("netcallRejected",t),this.packNetcallRecord({type:t.type,channelId:t.channelId,isCaller:!0,target:t.account,recordType:"netcallRejected"}),this.resetWhenHangup(),this.emit("callRejected",t),void 0)},S.onUserJoin=function(t){this.log("onUserJoin ",t);var e=t.account,n=t.uid;return!e&&n&&(t.account=e=this.getAccountWithUid(n)),e?void this.emitUserJoin(t):(this.needQueryAccountMap[n]=t,void this.nim.queryAccountUidMap(this.channelName,[n]))},S.emitUserJoin=function(t){var e=t.uid,n=t.isMeeting;this.remoteStreamInfo[e]=t,this.dataApi.start({uid:this.getUid()}),n?this.emit("joinChannel",{type:t.type,uid:t.uid,account:t.account}):(this.callAccepted||(this.callAccepted=!0),this.emit("callAccepted",{type:t.type,account:t.account,uid:t.uid}))},S.onUserLeft=function(t){var e=this,n=t.account,i=t.uid,o=t.isMeeting;o?(!n&&i&&(t.account=this.getAccountWithUid(i)),this.emit("leaveChannel",{account:t.account})):(this.log("on user left",t),this.calling&&setTimeout(function(){t.account=e.getAccountWithUid(t.uid),e.onHangup(t)},1e3))},S.onNetcallControl=function(t){this.emit("control",t)},S.onCalleeAckSync=function(t){this.emit("callerAckSync",t),this.isCurrentChannelId(t)&&this.resetWhenHangup()},S.onNotifyJoin=function(t){var e=t.accountUidMap,n=this.needQueryAccountMap;this.parseAccountUidMap(e);for(var i in e){var o=i,r=e[i];if(r in n){var s=n[r];s.account=o,this.emitUserJoin(s),delete n[r]}}},S.onHangup=function(t){this.dataApi.send(),this.emit("hangup",t),
this.isCurrentChannelId(t)&&this.resetWhenHangup()},S.hangup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.channelId;!e&&this.calling&&this.channelId&&(e=this.channelId),e&&(this.dataApi.send(),this.nim.hangup({channelId:e})),e===this.channelId&&(this.isCaller&&!this.callAccepted&&(this.log("cancelNetcallBeforeAccept",{channelId:e}),this.packNetcallRecord({recordType:"cancelNetcallBeforeAccept"})),this.resetWhenHangup())},S.packNetcallRecord=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.recordType,n=h.exist(t.type)?t.type:this.type,i=h.exist(t.channelId)?t.channelId:this.channelId,o=h.exist(t.duration)?t.duration:0,r=h.exist(t.isCaller)?t.isCaller:this.isCaller,s=h.exist(t.target)?t.target:this.target,a=this.getAccount(),c=r?a:s,u=r?s:a,l=+new Date;this.nim.protocol.onMsg({content:{msg:{attach:JSON.stringify({data:{calltype:n,channel:i,duration:o,ids:[a,s],time:l},id:e}),from:c,fromClientType:r?16:0,fromDeviceId:"",fromNick:"",idClient:h.guid(),idServer:h.guid(),scene:0,time:l,to:u,type:5}}})},S.resetWhenHangup=function(){this.resetStatus(),this.signalInited&&this.signal.stopSession()},S.control=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.command,i=e.channelId;if(i||(i=this.channelId),n&&i)return this.dataApi.update("call_control_type"),this.nim.netcallControl({channelId:i,type:n})["catch"](function(e){throw t.log(e),e})},S.setVideoViewSize=function(t){return this.signalInited?this.signal.setVideoViewSize(t):this.rejectWithNoSignal()},S.setVideoViewRemoteSize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.signalInited?(t.account&&(t.id=this.getUidWithAccount(t.account)),this.signal.setVideoViewRemoteSize(t)):this.rejectWithNoSignal()},S.setVideoScale=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.signalInited?(t.account&&(t.id=this.getUidWithAccount(t.account)),this.signal.setVideoScale(t)):this.rejectWithNoSignal()},S.startLocalStream=function(t){var e=this;if(this.dataApi.update("display"),this.signalInited&&!this.stream&&this.localStreamInfo){var n=t||this.container,i=this.localStreamInfo.port;this.stream=new g({client:this,url:m.genStreamUrl(i),container:n,mirror:this.mirror}),this.stream.on("resize",function(t){e.emit("streamResize",t)}),this.stream.on("error",function(t){e.emit("error",t)})}},S.stopLocalStream=function(){this.stream&&(this.stream.destroy(),this.stream=null)},S.startRemoteStream=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"p2p"===this.sessionMode?(t=this.getUidWithAccount(this.target),this.remoteContainer||this.target||this.nim.logger.error("不传参数且点对点模式实例化Netcall必须设置remoteContainer与target；传参数必须包含account，node"),!this.getRemoteStream(t)&&this.remoteStreamInfo[t]&&this.addRemoteStream(this.remoteStreamInfo[t])):(t=e.uid||this.getUidWithAccount(e.account),e.node=c.element.n2node(e.node),t&&e.node?this.addRemoteStream(this.remoteStreamInfo[t],e.node):this.nim.logger.error("不传参数且点对点模式实例化Netcall必须设置remoteContainer与target；传参数必须包含account，node"))},S.stopRemoteStream=function(t){return t?this.removeRemoteStream(t):this.removeRemoteStreams()},S.addRemoteStream=function(t,e){var n=this,i=t.uid,o=t.port;this.remoteStreams||(this.remoteStreams={});var r=this.remoteStreams[i];r&&r.destroy(),r=this.remoteStreams[i]=new g({client:this,isRemote:!0,url:m.genStreamUrl(o),container:e||this.remoteContainer,mirror:this.mirrorRemote}),r.on("resize",function(t){n.emit("remoteStreamResize",t)}),r.on("error",function(t){n.emit("error",t)})},S.removeRemoteStreams=function(){var t=this;this.remoteStreams&&Object.keys(this.remoteStreams).forEach(function(e){t.remoteStreams[e].destroy()}),this.remoteStreams={}},S.removeRemoteStream=function(t){var e=this.getUidWithAccount(t);if(!this.remoteStreams[e]){var n={code:"accountNotMatch"};throw n}this.remoteStreams[e].destroy()},S.getRemoteStream=function(t){var e=this.getUidWithAccount(t);return this.remoteStreams&&this.remoteStreams[e]},S.suspendLocalStream=function(){this.stream&&this.stream.suspend()},S.resumeLocalStream=function(){this.stream&&this.stream.resume()},S.suspendRemoteStream=function(t){var e=this.getRemoteStream(t||this.target);e&&e.suspend()},S.resumeRemoteStream=function(t){var e=this.getRemoteStream(t||this.target);e&&e.resume()},S.switchVideoToAudio=function(){var t=this;return this.signalInited?(this.dataApi.update("switch_p2p_type"),this.signal.switchVideoToAudio().then(function(){t.type=b.NETCALL_TYPE_AUDIO})):this.rejectWithNoSignal()},S.switchAudioToVideo=function(){var t=this;return this.signalInited?(this.dataApi.update("switch_p2p_type"),this.signal.switchAudioToVideo().then(function(){t.type=b.NETCALL_TYPE_VIDEO})):this.rejectWithNoSignal()},S.getDevicesOfType=function(t){return this.signalInited?this.signal.getDevicesOfType(t):this.rejectWithNoSignal()},S.getStoredDevicesOfType=function(t){return this.signalInited?(t=+t,t===b.DEVICE_TYPE_AUDIO_OUT_LOCAL&&(t=b.DEVICE_TYPE_AUDIO_OUT_CHAT),this.signal.devicesMap[t]):void this.rejectWithNoSignal()},S.hasDevicesOfType=function(t){return this.getStoredDevicesOfType(t)},S.getStartedDeviceOfType=function(t){return this.signalInited?this.signal.deviceMap[t]:this.rejectWithNoSignal()},S.hasStartedDeviceOfType=function(t){return this.getStartedDeviceOfType(t)},S.stopDevice=function(t){return this.signalInited?this.hasStartedDeviceOfType(t)?this.signal.stopDevice(t):p.resolve():this.rejectWithNoSignal()},S.startDevice=function(t){var e=t.type,n=t.device;if(this.signalInited){if(h.exist(e)&&!n){if(this.hasStartedDeviceOfType(e))return p.resolve();this.hasDevicesOfType(e)&&(n=t.device=this.getStoredDevicesOfType(e)[0])}return n?this.signal.startDevice(t):p.reject(a({type:"noDevice"},t))}return this.rejectWithNoSignal()},S.setSessionVideoQuality=function(t){if(this.signalInited){if(void 0!==t){var e=t;e===b.CHAT_VIDEO_QUALITY_540P?e=b.CHAT_VIDEO_QUALITY_720P:e===b.CHAT_VIDEO_QUALITY_720P&&(e=b.CHAT_VIDEO_QUALITY_540P),this.dataApi.update("video_quality",e||0)}return this.signal.setVideoQuality(t)}return this.rejectWithNoSignal()},S.setSessionVideoFrameRate=function(t){return this.signalInited?(this.dataApi.update("fps",void 0!==t?+t+1:0),this.signal.setVideoFrameRate(t)):this.rejectWithNoSignal()},S.setSessionVideoBitrate=function(t){return this.signalInited?(this.dataApi.update("video_max_encode_bitrate",t||""),this.signal.setVideoBitrate(t)):this.rejectWithNoSignal()},S.setCaptureVolume=function(t){return t=void 0===t?255:t,t.constructor===String&&(t=+t||255),this.signalInited?this.signal.setCaptureVolume(t):this.rejectWithNoSignal()},S.setPlayVolume=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};/(Number|String)/.test(t.constructor)&&(t={volume:t});var e=t,n=e.volume;return n=void 0===n?255:n,this.signalInited?this.signal.setPlayVolume(n):this.rejectWithNoSignal()},S.netDetect=function(t,e){return this.dataApi.update({key:"net_detect"}),t=void 0===t?b.NETDETECT_AUDIO:t,e=e||b.CHAT_VIDEO_QUALITY_480P,this.signalInited?this.signal.netDetect({appKey:this.nim.options.appKey,type:t,quality:e}):this.rejectWithNoSignal()},S.uploadLog=function(){var t=this;this.signalInited&&this.nim.getSimpleNosToken().then(function(e){t.signal.uploadLog(e)},function(e){t.log(e)})},S.onLogUploaded=function(t){this.nim.uploadSdkLogUrl(t)},S.log=function(){var t=this.nim.logger;t.log.apply(t,arguments)},S.info=function(){var t=this.nim.logger;t.info.apply(t,arguments)},S.destroy=function(){},S=Object.assign(S,d["default"]),t.exports=T,n(245)},236:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=void 0,a=n(4),c=n(237),u=n(259),l=n(258),d=function(t){function e(n){i(this,e);var r=o(this,t.call(this));return s.merge(r,n),r.init(),r}return r(e,t),e}(a);d.install=function(t){s=t.util};var h=d.prototype;h.init=function(){this.reset()},h.reset=function(){this.width=0,this.height=0},h.initCanvas=function(t){s.merge(this,t);var e=this.container||document.body,n=this.canvas;n||(n=this.canvas=document.createElement("canvas"),e.appendChild(n)),n.width=this.width,n.height=this.height;var i=this.gl;if(i||(i=this.gl=c.getWebGLContext(n)),i)i.viewport(0,0,this.width,this.height),i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT),c.initShaders(i,u,l),this.initBuffer(i),this.initTextures(i);else{var o={code:"notSupportWebGl"};this.emit("error",o)}},h.initBuffer=function(t){this.positionLocation=t.getAttribLocation(t.program,"a_position"),this.texCoordLocation=t.getAttribLocation(t.program,"a_texCoord"),this.texCoordBuffer=t.createBuffer()},h.initTextures=function(t){this.yTexture=this.createTexture(t.TEXTURE0),this.uTexture=this.createTexture(t.TEXTURE1),this.vTexture=this.createTexture(t.TEXTURE2);var e=t.getUniformLocation(t.program,"Ytex");t.uniform1i(e,0);var n=t.getUniformLocation(t.program,"Utex");t.uniform1i(n,1);var i=t.getUniformLocation(t.program,"Vtex");t.uniform1i(i,2)},h.createTexture=function(t){var e=this.gl,n=e.createTexture();return e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),n},h.destroyTextures=function(){var t=this.gl;t&&(t.deleteTexture(this.yTexture),t.deleteTexture(this.uTexture),t.deleteTexture(this.vTexture)),this.yTexture=null,this.uTexture=null,this.vTexture=null},h.destroyBuffer=function(){var t=this.gl;t&&this.texCoordBuffer&&t.deleteBuffer(this.texCoordBuffer),this.texCoordBuffer=null},h.updateShaders=function(){var t=this.gl,e=void 0;e=this.mirror?new Float32Array([-1,1,1,0,-1,-1,1,1,1,1,0,0,1,-1,0,1]):new Float32Array([-1,1,0,0,-1,-1,0,1,1,1,1,0,1,-1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW);var n=e.BYTES_PER_ELEMENT;t.vertexAttribPointer(this.positionLocation,2,t.FLOAT,!1,4*n,0),t.vertexAttribPointer(this.texCoordLocation,2,t.FLOAT,!1,4*n,2*n),t.enableVertexAttribArray(this.positionLocation),t.enableVertexAttribArray(this.texCoordLocation)},h.updateTextures=function(t){var e=t.y,n=t.u,i=t.v,o=this.gl,r=this.width,s=this.height;this.updateTexture(o.TEXTURE0,this.yTexture,e,r,s),this.updateTexture(o.TEXTURE1,this.uTexture,n,r/2,s/2),this.updateTexture(o.TEXTURE2,this.vTexture,i,r/2,s/2),o.finish()},h.updateTexture=function(t,e,n,i,o){var r=this.gl;r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,i,o,0,r.LUMINANCE,r.UNSIGNED_BYTE,n)},h.drawImage=function(t){if(!this.destroyed){var e=t.width,n=t.height,i=t.y,o=t.u,r=t.v;e===this.width&&n===this.height||(this.width=e,this.height=n,this.clean(),this.initCanvas({width:e,height:n}),this.emit("resize",{width:e,height:n,isRemote:this.isRemote,container:this.container})),this.updateShaders(),this.updateTextures({y:i,u:o,v:r});var s=this.gl;s.drawArrays(s.TRIANGLE_STRIP,0,4)}},h.destroy=function(){this.destroyed||(this.destroyed=!0,this.clean(),this.reset())},h.clean=function(){this.destroyTextures(),this.destroyBuffer(),this.removeGl()},h.removeGl=function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null,this.canvasInited=!1,this.gl=null},t.exports=d},237:function(t,e){"use strict";var n={},i=n.create3DContext=function(t,e){for(var n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=null,o=0;o<n.length;++o){try{i=t.getContext(n[o],e)}catch(r){}if(i){console.log("use",n[o]);break}}return i};n.initShaders=function(t,e,n){var i=o(t,e,n);return i?(t.useProgram(i),t.program=i,!0):(console.log("Failed to create program"),!1)};var o=n.createProgram=function(t,e,n){var i=r(t,t.VERTEX_SHADER,e),o=r(t,t.FRAGMENT_SHADER,n);if(!i||!o)return null;var s=t.createProgram();if(!s)return null;t.attachShader(s,i),t.attachShader(s,o),t.linkProgram(s);var a=t.getProgramParameter(s,t.LINK_STATUS);if(!a){var c=t.getProgramInfoLog(s);return console.log("Failed to link program: "+c),t.deleteProgram(s),t.deleteShader(o),t.deleteShader(i),null}return s},r=n.loadShader=function(t,e,n){var i=t.createShader(e);return null==i?(console.log("unable to create shader"),null):(t.shaderSource(i,n),t.compileShader(i),i)};n.getWebGLContext=function(t,e){var n=i(t);return n?n:null},window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}()),window.cancelAnimationFrame||(window.cancelAnimationFrame=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.clearTimeout),t.exports=n},244:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=n(38),s=i(r),a=n(39),c=i(a),u=n(2),l=i(u),d="//"+l["default"].roomserver+"/v1/sdk/command/rooms/";e["default"]={parseAccountUidMap:function(t){var e=this;Object.keys(t).forEach(function(n){e.addAccountUidMap({account:n,uid:t[n]})})},addAccountUidMap:function(t){var e=t.account,n=t.uid;this.uidAccountMap||(this.uidAccountMap={}),this.uidAccountMap[n]=e,this.accountUidMap||(this.accountUidMap={}),this.accountUidMap[e]=n},getAccountWithUid:function(t){if(this.uidAccountMap)return this.uidAccountMap[t]},getUidWithAccount:function(t){if(this.accountUidMap)return this.accountUidMap[t]},onError:function(t){this.emit("error",t)},setAudioBlack:function(t){var e=this.getUidWithAccount(t);if(e)return this.signal.setAudioBlack(this.getUidWithAccount(t),1);var n={code:"accountNotMatch"};return Promise.reject(n)},setAudioStart:function(t){var e=this.getUidWithAccount(t);if(e)return this.signal.setAudioBlack(this.getUidWithAccount(t),0);var n={code:"accountNotMatch"};return Promise.reject(n)},setVideoBlack:function(t){return this.signal.setVideoBlack(this.getUidWithAccount(t),1)},setVideoShow:function(t){return this.signal.setVideoBlack(this.getUidWithAccount(t),0)},startRecordMp4:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dataApi.update({key:"record"}),c["default"].verifyOptions(t,"path"),t.account&&(t.id=t.account===this.account?0:this.getUidWithAccount(t.account)),this.signal.startRecordMp4(t)},stopRecordMp4:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.account&&(t.id=t.account===this.account?0:this.getUidWithAccount(t.account)),this.signal.stopRecordMp4(t)},startRecordAac:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.dataApi.update({key:"audio_record"}),c["default"].verifyOptions(t,"path"),this.signal.startRecordAac(t)},stopRecordAac:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.signal.stopRecordAac(t)},onRecordMp4:function(t,e){t.type=e,this.emit("recordMp4",t)},setNetcallSession:function(t){return this.calling?Promise.reject({type:"statusNotMatch",error:"开启会话失败: 当前正在通话中"}):(this.calling=!0,this.channelId=t.channelId,this.type=+t.netcallType,this.imInfo=t,this.imInfo.rtcUrls=t.rtcServerMap,this.beCalledInfo=this.imInfo,this.target=t.target.account,this.parseAccountUidMap(t.accountUidMap),this.signal.startSession(o({},this.imInfo,{type:this.type},this.imInfo.sessionConfig),!1))},ans:function(t){return this.signal?(this.dataApi.update({key:"ans"}),this.sessionConfig.ns=~~t,this.signal.audioControl({ns:this.sessionConfig.ns})):Promise.reject({code:"noConnection"})},aec:function(t){return this.signal?(this.dataApi.update({key:"aec"}),this.sessionConfig.aec=~~t,this.signal.audioControl({aec:this.sessionConfig.aec})):Promise.reject({code:"noConnection"})},voiceDetection:function(t){return this.signal?(this.sessionConfig.vad=~~t,this.signal.audioControl({vad:this.sessionConfig.vad})):Promise.reject({code:"noConnection"})},awc:function(t){return this.signal?(this.dataApi.update({key:"awc"}),this.sessionConfig.awc=~~t,this.signal.awc(this.sessionConfig.awc)):Promise.reject({code:"noConnection"})},updateRtmpHostVideo:function(t){var e=t.account,n=t.uid;if(e&&(n=this.getUidWithAccount(e)),!n)return Promise.reject("账号不在房间中，无法进行操作");var i=d+this.channelId,o=this.callerInfo&&this.callerInfo.serverInfo&&this.callerInfo.serverInfo.token||"";return(0,s["default"])({type:"post",url:i,data:{suid:this.getUid(),cid:this.channelId,uid:+n,cmd:10001},header:{Token:o}}).then(function(t){if(200===t.code)return Promise.resolve();var e=void 0;switch(t.code){case 404:e="房间不存在";break;case 405:e="目标用户不在房间中";break;case 406:e="没有权限";break;case 417:e="请求数据不对";break;case 600:e="服务器内部错误";break;default:e="请求参数不正确"}return Promise.reject(e)})}},t.exports=e["default"]},245:function(t,e,n){"use strict";var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=n(235),r=n(115),s=o.prototype,a=void 0;s.setUtil=function(t){a=t},s.createChannel=function(t){return a.verifyOptions(t,"channelName"),t.custom=t.custom||"",this.dataApi.update("meeting"),t.webrtcEnable=!0,this.nim.createChannel(t)},s.joinChannel=function(t){var e=this;this.dataApi.update("meeting"),a.verifyOptions(t,"channelName type");var n=t.type,o=t.sessionConfig,s=void 0===o?{}:o;if(s.bypassRtmp=t.liveEnable,s.customLayout=t.layout||t.customLayout,t.liveEnable&&this.dataApi.update("bypass",void 0!==s.splitMode?+s.splitMode+1:0),s.highAudio&&this.dataApi.update("hd_audio"),void 0!==s.videoFrameRate&&this.dataApi.update("fps",0===+s.videoFrameRate?0:+s.videoFrameRate+1),void 0!==s.videoEncodeMode&&this.dataApi.update("video_adaptive_strategy",s.videoEncodeMode||0),void 0!==s.videoBitrate&&this.dataApi.update("video_max_encode_bitrate",s.videoBitrate||""),void 0!==s.videoQuality){var c=s.videoQuality;c===r.CHAT_VIDEO_QUALITY_540P?c=r.CHAT_VIDEO_QUALITY_720P:c===r.CHAT_VIDEO_QUALITY_720P&&(c=r.CHAT_VIDEO_QUALITY_540P),this.dataApi.update("video_quality",c||0)}if(s.awc&&this.dataApi.update({key:"awc"}),s.ans&&this.dataApi.update({key:"ans"}),s.aec&&this.dataApi.update({key:"aec"}),this.signalInited)return this.nim.joinChannel({channelName:t.channelName,liveEnable:t.liveEnable,webrtcEnable:!0}).then(function(o){return o.serverInfo=JSON.parse(o.serverMap),e.callerInfo=o,e.channelId=o.channelId,e.channelName=t.channelName,e.sessionMode="meeting",e.parseAccountUidMap(o.accountUidMap),o.uid=e.getUidWithAccount(e.account),e.dataApi.start({uid:o.uid}),e.signal.startSession(i({},o,{type:n},t.sessionConfig),!0).then(function(t){return t.custom=o.custom,t})});var u={code:"noConnection"};return Promise.reject(u)},s.leaveChannel=function(){if(this.signalInited)return this.dataApi.send(),this.signal.stopSession();var t={code:"noConnection"};return Promise.reject(t)},s.changeRoleToPlayer=function(){return this.signal.setRole(0)},s.changeRoleToAudience=function(){return this.signal.setRole(1)},s.updateRtmpUrl=function(t){return this.signal.updateRtmpUrl(t)}},246:function(t,e){"use strict";var n="wss://localhost.netease.im:",i={baseUrl:n,signalUrl:n+"30000",streamUrl:n+"40000",genStreamUrl:function(t){return""+n+t}};t.exports=i},247:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},a=void 0,c=n(4),u=n(115),l=n(249),d=n(66),h=function(t){function e(n){i(this,e);var r=o(this,t.call(this));return a.merge(r,n),r.reset(),window.addEventListener("beforeunload",function(){r.destroy()}),r}return r(e,t),e}(c);h.install=function(t){a=t.util};var p=h.prototype;p.reset=function(){this.inited=!1,this.isMeeting=!1,this.hasInvokePC=!1,this.cmdId=1,this.cmdTasksMap={},this.sessionStopped=!1,this.devicesMap={},this.deviceMap={},this.initSocket(),this.audioGroup={aec:1,ns:1,vad:1,awc:0}},p.initSocket=function(){var t=this.socket=new WebSocket(this.url);t.onopen=this.onOpen.bind(this),t.onmessage=this.onMessage.bind(this),t.onerror=this.onError.bind(this),t.onclose=this.onClose.bind(this)},p.onOpen=function(t){var e=this,n=this.heartbeat?1:0,i=this.getName()+" open -> signal.js";this.inited=!0,this.logToConsole(i),this.log(i),this.emit("open"),this.sendCmd({type:"on_init",info:{account:this.account,type:this.kickLast?1:0,heartbeat:n,app_key:this.appkey}}).then(this.onInit.bind(this))["catch"](function(t){e.logToConsole("init error -> signal.js",t),e.emit("initError",t)})},p.onError=function(t){if(!this.destroyed&&this.inited){var e=this.getName()+" error -> signal.js";this.logToConsole(e)}},p.onClose=function(t){var e=this;if(!this.destroyed)if(this.inited){var n=this.getName()+" close -> signal.js : "+t.code;this.logToConsole(n),this.inited=!1,this.emit("close")}else{this.hasInvokePC||(this.hasInvokePC=!0,this.invokePC());var i=this.backoff;i||(i=this.backoff=new d({min:1e3,max:2e3})),3===i.attempts?this.emit("initError",{code:"noPC"}):setTimeout(function(){e.initSocket()},i.duration())}},p.invokePC=function(){var t="NIMWebAgent:invokePC",e=document.createElement("iframe");e.src=t,document.body.appendChild(e),setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},0)},p.onMessage=function(t){if(!this.destroyed){var e=JSON.parse(t.data),n=e.cmd_id,i=e.cmd_type,o=e.cmd_info;this.shouldPrintMsg({cmdType:i,cmdInfo:o})&&"on_heartbeat_notify"!==i&&this.client.info("signal socket msg",e);var r=this.cmdTasksMap[n];if(r)delete this.cmdTasksMap[n],200===o.code?r.resolve(o):r.reject(o);else switch(i){case"device_status_notify":this.onDeviceStatus(o);break;case"session_notify":this.onSessionNotify(o);break;case"upload_log_notify":this.onUploadLogNotify(o)}}},p.shouldPrintMsg=function(t){var e=t.cmdType,n=t.cmdInfo;return"session_notify"!==e||!n.audio_volume&&!n.net&&!n.static_info},p.sendCmd=function(t){var e=this;return new Promise(function(n,i){var o="on_heartbeat"===t.type?0:e.cmdId++,r=s({cmd_id:o,cmd_type:t.type,cmd_info:t.info||{}},t.extra);e.socket&&e.socket.readyState===WebSocket.OPEN?("on_heartbeat"!==t.type&&e.logToConsole("send signal cmd",r),e.cmdTasksMap[o]={resolve:n,reject:i},e.socket.send(JSON.stringify(r))):i({code:"noConnection"})})},p.onInit=function(t){var e=t.code,n=t.version,i=t.port,o=t.device_list_notify;200===e&&(o.forEach(this.onDevices,this),this.emit("init",{port:i,version:n,code:e}),this.startHeartBeat())},p.startHeartBeat=function(){var t=this;this.heartBeatTimer&&this.stopHeartBeat(),this.heartBeatTimer=setInterval(function(){t.sendCmd({type:"on_heartbeat",info:{}})["catch"](function(){t.emit("heartBeatError",{type:"heartbeatError"})})},15e3)},p.stopHeartBeat=function(){clearInterval(this.heartBeatTimer),this.heartBeatTimer=null},p.setVideoViewSize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=parseInt(t.width)||0,n=parseInt(t.height)||0,i=void 0===t.cut?1:~~t.cut;return this.sendCmd({type:"on_capture_video_size",info:{width:e,height:n,cut:i}})},p.setVideoViewRemoteSize=function(t){var e=parseInt(t.width)||0,n=parseInt(t.height)||0,i=t.id||0,o=void 0===t.cut?1:~~t.cut;return this.sendCmd({type:"on_rec_video_size",info:{id:i,width:e,height:n,cut:o}})},p.setVideoScale=function(t){var e=t.type,n=void 0===e?u.CHAT_VIDEO_SCALE_None:e,i=t.id;return this.sendCmd({type:"on_send_video_Scale",info:{id:i,type:n}})},p.getDevicesOfType=function(t){var e=this;return this.sendCmd({type:"on_get_devices",info:{type:t}}).then(function(t){return t.devices=t.devices||[],e.onDevices(t),t})["catch"](function(t){throw t})},p.onDevices=function(t){var e=t.type,n=t.devices;if(n&&n.length){l.sortDevices(n);var i=u.getDeviceTypeStr(e);i&&(this.devicesMap[e]=n,this.emit("devices",{type:e,typeStr:i,devices:n}))}},p.startAllDevices=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.videoQuality,i=e.audioOutType;Object.keys(this.devicesMap).forEach(function(e){e=+e,e===u.DEVICE_TYPE_AUDIO_OUT_CHAT&&i===u.DEVICE_TYPE_AUDIO_OUT_LOCAL&&(e=i);var o=t.devicesMap[e];t.startDevice({device:o[0],type:e,videoQuality:n})})},p.startDevice=function(t){var e=this,n=t.device,i=t.type,o=t.width,r=t.height;if(n){i=+i;var s={type:i,path:n.path};return i===u.DEVICE_TYPE_VIDEO&&(s.width=parseInt(o)||0,s.height=parseInt(r)||0),this.deviceMap[i]=n,this.sendCmd({type:"on_start_device",info:s})["catch"](function(){throw delete e.deviceMap[i],s})}},p.stopDevice=function(t){var e=this,n=this.deviceMap[t];return delete this.deviceMap[t],this.sendCmd({type:"on_stop_device",info:{type:t}})["catch"](function(){e.deviceMap[t]=n})},p.onDeviceStatus=function(t){var e=t.type,n=t.status,i=1===(1&n),o=4===(4&n),r=8===(8&n),a=16===(16&n);r&&(this.deviceMap[e]=t,this.emit("deviceStatus",s({},t,{status:"started"}))),a&&(delete this.deviceMap[e],this.emit("deviceStatus",s({},t,{status:"stopped"}))),o&&(this.deviceMap[e]=t,this.emit("deviceStatus",s({},t,{status:"reset"}))),i&&this.emit("deviceStatus",s({},t,{status:"change"}))},p.startSession=function(t,e){var n=this;this.sessionStopped=!1;var i=a.guid();this.sessionId=i;var o=t.type;this.type=o;var r={id:t.uid,cid:t.channelId,type:o,p2p_connect:1,dispatch:t.serverMap,config:t.clientConfig,v_encode_mode:this.normalizeVideoEncodeMode(t.videoEncodeMode),video_quality:this.normalizeVideoQuality(t.videoQuality),video_record:t.recordVideo?1:0,record:t.recordAudio?1:0,high_rate:t.highAudio?1:0,frame_rate:this.normalizeVideoFrameRate(t.videoFrameRate),max_video_rate:this.normalizeVideoBitrate(t.videoBitrate),custom_layout:t.customLayout};return e&&(r.meeting_mode=1,r.bypass_rtmp=t.bypassRtmp?1:0,r.rtmp_url=t.rtmpUrl||"",r.rtmp_record=t.rtmpRecord?1:0,r.split_mode=t.splitMode||0),r.dispatch&&r.dispatch.constructor!==String&&(r.dispatch=JSON.stringify(r.dispatch)),this.sendCmd({type:"on_start_chat",info:r,extra:{session_id:i}}).then(function(i){var o=i.login,r=i.error;if(r)throw r;return n.isMeeting=e,void 0!==t.ns&&n.audioControl({ns:t.ns}),void 0!==t.vad&&n.audioControl({vad:t.vad}),void 0!==t.aec&&n.audioControl({aec:t.aec}),void 0!==t.awc&&n.awc(t.awc),{login:o}})},p.stopSession=function(){return this.sessionStopped?Promise.resolve():(this.sessionStopped=!0,this.isMeeting=!1,this.sendCmd({type:"on_stop_chat"}))},p.clear=function(){this.sendCmd({type:"on_clear"})},p.switchVideoToAudio=function(){return this.sendCmd({type:"on_set_chat_mode",info:{type:u.NETCALL_TYPE_AUDIO}})},p.switchAudioToVideo=function(){return this.sendCmd({type:"on_set_chat_mode",info:{type:u.NETCALL_TYPE_VIDEO}})},p.logToConsole=function(){var t=this.client;t&&t.log.apply(t,arguments)},p.log=function(t){t&&this.doLog({msg:t,level:3})},p.warn=function(t){t&&this.doLog({msg:t,level:2})},p.err=function(t){t&&this.doLog({msg:t,level:1})},p.doLog=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.msg,n=t.level;return this.sendCmd({type:"on_log",info:{type:n,content:""+e}})["catch"](function(){})},p.uploadLog=function(t){var e=t.bucket,n=t.objectName,i=t.token;return this.sendCmd({type:"on_upload_log",info:{nos_bucket:e,nos_object:n,nos_header_token:i}})["catch"](function(){})},p.normalizeVideoEncodeMode=function(t){return parseInt(t)||u.CHAT_VIDEO_ENCODEMODE_NORMAL},p.normalizeVideoQuality=function(t){return parseInt(t)||u.CHAT_VIDEO_QUALITY_480P},p.setVideoQuality=function(t){return this.sendCmd({type:"on_set_video_quality",info:{type:this.normalizeVideoQuality(t)}})},p.normalizeVideoFrameRate=function(t){return parseInt(t)||u.CHAT_VIDEO_FRAME_RATE_NORMAL},p.setVideoFrameRate=function(t){return this.sendCmd({type:"on_set_video_frame_rate",info:{type:this.normalizeVideoFrameRate(t)}})},p.normalizeVideoBitrate=function(t){return parseInt(t)||0},p.setVideoBitrate=function(t){return this.sendCmd({type:"on_set_video_bitrate",info:{code:this.normalizeVideoBitrate(t)}})},p.netDetect=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.appKey,n=t.type,i=t.quality,o=void 0===i?0:i;return this.sendCmd({type:"on_net_detect",info:{app_key:e,type:n,quality:o}})},p.normalizeVolumn=function(t){return t=+t,a.isNumber(t)&&!isNaN(t)||(t=255),t<0&&(t=0),t>255&&(t=255),t},p.setCaptureVolume=function(t){return t=this.normalizeVolumn(t),this.sendCmd({type:"on_capture_volume",info:{status:t}})},p.setPlayVolume=function(t){return t=this.normalizeVolumn(t),this.sendCmd({type:"on_play_volume",info:{status:t}})},p.setRole=function(t){return this.sendCmd({type:"on_set_viewer",info:{status:t}})},p.setAudioBlack=function(t,e){return this.sendCmd({type:"on_set_audio_black",info:{id:t,status:e}})},p.setVideoBlack=function(t,e){return this.sendCmd({type:"on_set_video_black",info:{id:t,status:e}})},p.updateRtmpUrl=function(t){return this.sendCmd({type:"on_update_rtmp_url",info:{content:t}})},p.startRecordMp4=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.path,n=t.id,i=void 0===n?"":n,o=t.aac,r=void 0!==o&&o,s=t.recode,a=void 0===s||s,c=t.width,u=void 0===c?0:c,l=t.height,d=void 0===l?0:l;return console.log("startRecordMp4",r,a,u,d),this.sendCmd({type:"on_record_mp4",info:{path:e,id:i,mp4_audio:~~r,mp4_recode:!!a,mp4_width:+u,mp4_height:+d}})},p.stopRecordMp4=function(t){var e=t.id,n=void 0===e?0:e;return this.sendCmd({type:"on_stop_record_mp4",info:{id:n}})},p.startRecordAac=function(t){var e=t.path;return this.sendCmd({type:"on_record_aac",info:{path:e}})},p.stopRecordAac=function(){return this.sendCmd({type:"on_stop_record_aac",info:{}})},p.onSessionNotify=function(t){t&&(t.user_joined?(console.log("onSessionNotify ",t),this.emit("userJoined",{uid:t.user_joined.id,port:t.user_joined.port,type:this.type,isMeeting:this.isMeeting})):t.user_left?this.emit("userLeft",{uid:t.user_left.id,type:t.user_left.status,isMeeting:this.isMeeting}):t.net?this.emit("netStatus",t.net):t.static_info?this.emit("statistics",t.static_info):t.audio_volume?this.emit("audioVolume",t.audio_volume):t.error?this.emit("error",t.error):t.mp4_start?this.emit("recordMp4",t.mp4_start,"start"):t.mp4_close&&this.emit("recordMp4",t.mp4_close,"close"))},p.onUploadLogNotify=function(t){var e=t.code,n=t.url;200===e&&this.emit("logUploaded",{url:n})},p.getName=function(){return"signal socket "+this.url},p.destroy=function(){this.destroyed=!0,this.stopHeartBeat();var t="signal close -> signal.js";this.logToConsole(t),this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.readyState===WebSocket.OPEN&&(this.clear(),
this.socket.close()),this.socket=null)},p.audioControl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.merge(this.audioGroup,t),this.sendCmd({type:"on_audio_process",info:this.audioGroup,id:++this.cmdId})},p.awc=function(t){return this.sendCmd({type:"on_audio_howling",info:{status:~~t},id:++this.cmdId})},t.exports=h},248:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=void 0,a=n(4),c=n(236),u=n(257),l=function(t){function e(n){i(this,e);var r=o(this,t.call(this));return s.merge(r,n),r.init(),r}return r(e,t),e}(a);l.install=function(t){s=t.util};var d=l.prototype;d.init=function(){this.reset(),this.initRender(),this.initWorker(),window.addEventListener("beforeunload",this.destroy.bind(this))},d.initRender=function(){var t=this;this.render=new c({client:this.client,stream:this,isRemote:this.isRemote,container:this.container,mirror:this.mirror}),this.render.on("resize",function(e){t.emit("resize",e)}),this.render.on("error",function(e){t.emit("error",e)})},d.reset=function(){this.currFrameCount=0,this.width=0,this.height=0,this.timetag=0,this.worker=null,this.render=null},d.initWorker=function(){var t=this,e=new Blob([u],{type:"application/javascript"}),n=this.worker=new Worker(URL.createObjectURL(e));n.addEventListener("message",function(e){var n=e.data;switch(n.cmd){case"open":t.onOpen();break;case"error":t.onError();break;case"close":t.onClose();break;case"message":t.onMessage(n)}}),this.sendWorkerCmd({cmd:"init",info:{url:this.url}})},d.destroyWorker=function(){this.worker&&this.worker.terminate()},d.sendWorkerCmd=function(t){this.worker&&this.worker.postMessage(t)},d.getName=function(){return(this.isRemote?"remote ":"")+"stream socket "+this.url},d.onOpen=function(t){var e=this.getName()+" open -> stream.js";this.logToConsole(e),this.logToPC(e)},d.startStatisticsTimer=function(){var t=this;this.statisticsTimer=setInterval(function(){var e=t.currFrameCount-t.lastFrameCount;t.sendWorkerCmd({cmd:"msg",info:{cmd:"statistics",info:{lastFrameCount:t.lastFrameCount,fps:e,latency:t.latency}}}),t.lastFrameCount=t.currFrameCount,t.latency=0},1e3)},d.onError=function(t){if(!this.destroyed){var e=this.getName()+" error -> stream.js";this.logToConsole(e),this.logToPC(e),this.destroy()}},d.onClose=function(t){this.destroy(t)},d.onMessage=function(t){var e=t.data;if(!this.destroyed&&e instanceof ArrayBuffer){var n=e.byteLength;this.render&&!this.suspended&&this.renderFrame(e,n)}},d.renderFrame=function(t,e){var n=16,i=new DataView(t),o=this.width=i.getUint32(0),r=this.height=i.getUint32(4),s=i.getUint32(8),a=i.getUint32(12);this.timetag=1e3*s+a;var c=o*r,u=c/4,l=c/4;if(n+c+u+l!==e){var d="yuv数据长度不匹配: total "+e+", meta "+n+", width "+o+", height "+r+", yLength "+c+" uLength "+u+" vLength "+l;return this.logToConsole(d),void this.logToPC(d)}this.currFrameCount++,this.scheduleRender({id:this.currFrameCount,width:o,height:r,y:new Uint8Array(t,n,c),u:new Uint8Array(t,n+c,u),v:new Uint8Array(t,n+c+u)})},d.scheduleRender=function(t){this.render&&!this.suspended&&this.render.drawImage(t)},d.suspend=function(){this.suspended=!0},d.resume=function(){this.suspended=!1},d.destroy=function(t){this.sendWorkerCmd({cmd:"close",info:{cmd_type:"on_clear_media"}}),this.destroyed=!0,this.render&&this.render.destroy(),this.reset();var e=t&&t.constructor===Object?t.code:"",n=this.getName()+" destroy: code - "+e+" -> stream.js";this.logToConsole(n),this.logToPC(n)},d.logToConsole=function(){var t=this.client;t&&t.log.apply(t,arguments)},d.logToPC=function(){var t=this.client;if(t){var e=t.signal;e&&e.log.apply(e,arguments)}},t.exports=l},249:function(t,e){"use strict";var n={};n.sortDevices=function(t){t&&t.length>1&&t.sort(function(t,e){var n=t.name.toLowerCase().indexOf("virtual")!==-1,i=t.path.toLowerCase().indexOf("virtual")!==-1,o=e.name.toLowerCase().indexOf("virtual")!==-1,r=e.path.toLowerCase().indexOf("virtual")!==-1;return i?1:r?-1:n&&o?0:n?1:o?-1:0})},t.exports=n},257:function(t,e){t.exports="'use strict';\n\n/* 该web worker 职能为向 websocket 发送指令及数据*/\n\nvar that = {};\n\nthat.init = function (data) {\n  if (!that.socket) {\n    var url = that.url = data.info.url;\n    var socket = that.socket = new WebSocket(url);\n    socket.onopen = function (event) {\n      postMessage({\n        cmd: 'open'\n      });\n    };\n    socket.onmessage = function (event) {\n      postMessage({\n        cmd: 'message',\n        data: event.data\n      }, [event.data]);\n    };\n    socket.onerror = function (event) {\n      postMessage({\n        cmd: 'error'\n      });\n    };\n    socket.onclose = function (event) {\n      postMessage({ // web 端被动结束\n        cmd: 'close'\n      });\n    };\n    socket.binaryType = 'arraybuffer';\n  }\n};\n\nthat.close = function () {\n  if (that.socket) {\n    that.socket.onopen = null;\n    that.socket.onmessage = null;\n    that.socket.onerror = null;\n    that.socket.onclose = null;\n    that.socket.close(); // 结束socket\n    that.socket = null;\n  }\n  self.close(); // 结束worker，web端主动\n};\n\nthat.send = function (obj) {\n  if (that.socket && that.socket.readyState === WebSocket.OPEN) {\n    that.socket.send(JSON.stringify(obj));\n  }\n};\n// 侦听主线程的worker消息\nself.addEventListener('message', function (event) {\n  var data = event.data;\n  switch (data.cmd) {\n    case 'init':\n      // worker第一步2\n      that.init(data);\n      break;\n    case 'close':\n      // web发起，结束worker及相应socket\n      that.send(data.info);\n      that.close(data);\n      break;\n    case 'msg':\n      that.send(data.info);\n      break;\n  }\n});"},258:function(t,e){t.exports="precision mediump float;\nuniform sampler2D Ytex, Utex, Vtex;\nvarying vec2 v_texCoord;\nvoid main(void) {\n  float r, g, b, y, u, v;\n  vec4 yuv, rgb;\n  y = texture2D(Ytex, v_texCoord).r;\n  u = texture2D(Utex, v_texCoord).r;\n  v = texture2D(Vtex, v_texCoord).r;\n  yuv = vec4(y, u, v, 1.0);\n  yuv = yuv - vec4(0.0625, 0.5, 0.5, 0.0);\n  yuv = mat4(\n    1.1643, 0.0, 0.0, 0.0,\n    0.0, 1.0, 0.0, 0.0,\n    0.0, 0.0, 1.0, 0.0,\n    0.0, 0.0, 0.0, 1.0\n  ) * yuv;\n  rgb = mat4(\n    1.0, 1.0, 1.0, 0.0,\n    0.0, -0.3917, 2.017, 0.0,\n    1.5958, -0.8129, 0.0, 0.0,\n    0.0, 0.0, 0.0, 1.0\n  ) * yuv;\n  gl_FragColor = rgb;\n  // y = 1.1643 * (y - 0.0625);\n  // u = u - 0.5;\n  // v = v - 0.5;\n  // r = y + 1.5958 * v;\n  // g = y - 0.39173 * u - 0.81290 * v;\n  // b = y + 2.017 * u;\n  // gl_FragColor = vec4(r, g, b, 1.0);\n}\n"},259:function(t,e){t.exports="attribute vec4 a_position;\nattribute vec2 a_texCoord;\nvarying vec2 v_texCoord;\nvoid main () {\n  gl_Position = a_position;\n  v_texCoord = a_texCoord;\n}\n"}})});